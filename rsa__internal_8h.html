<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPTIGA™ Trust M  Host Library Documentation: rsa_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DoxygenLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPTIGA™ Trust M  Host Library Documentation
   &#160;<span id="projectnumber">v3.00.2490</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('rsa__internal_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rsa_internal.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Context-independent RSA helper functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bignum_8h_source.html">bignum.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rsa_internal.h:</div>
<div class="dyncontent">
<div class="center"><img src="rsa__internal_8h__incl.png" border="0" usemap="#arsa__internal_8h" alt=""/></div>
<map name="rsa__internal_8h" id="rsa__internal_8h">
<area shape="rect" title="Context&#45;independent RSA helper functions." alt="" coords="55,5,155,32"/>
<area shape="rect" href="config_8h.html" title="Configuration options (set of defines)" alt="" coords="27,155,93,181"/>
<area shape="rect" href="bignum_8h.html" title="Multi&#45;precision integer library." alt="" coords="109,80,184,107"/>
<area shape="rect" href="check__config_8h.html" title="Consistency checks for configuration options." alt="" coords="5,229,115,256"/>
<area shape="rect" title=" " alt="" coords="118,155,186,181"/>
<area shape="rect" title=" " alt="" coords="210,155,275,181"/>
</map>
</div>
</div>
<p><a href="rsa__internal_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a23ff16b5cc6b742a732256d18fcae367"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa__internal_8h.html#a23ff16b5cc6b742a732256d18fcae367">mbedtls_rsa_deduce_primes</a> (<a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *N, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *E, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *D, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *P, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *Q)</td></tr>
<tr class="memdesc:a23ff16b5cc6b742a732256d18fcae367"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute RSA prime moduli P, Q from public modulus N=PQ and a pair of private and public key.  <a href="rsa__internal_8h.html#a23ff16b5cc6b742a732256d18fcae367">More...</a><br /></td></tr>
<tr class="separator:a23ff16b5cc6b742a732256d18fcae367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071d0f2ff7de73ddcc45fa536a39e354"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa__internal_8h.html#a071d0f2ff7de73ddcc45fa536a39e354">mbedtls_rsa_deduce_private_exponent</a> (<a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *P, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *Q, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *E, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *D)</td></tr>
<tr class="memdesc:a071d0f2ff7de73ddcc45fa536a39e354"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute RSA private exponent from prime moduli and public key.  <a href="rsa__internal_8h.html#a071d0f2ff7de73ddcc45fa536a39e354">More...</a><br /></td></tr>
<tr class="separator:a071d0f2ff7de73ddcc45fa536a39e354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97172b64cc6cc43ff86655a7acdc094b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa__internal_8h.html#a97172b64cc6cc43ff86655a7acdc094b">mbedtls_rsa_deduce_crt</a> (const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *P, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *D, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *DP, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *DQ, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *QP)</td></tr>
<tr class="memdesc:a97172b64cc6cc43ff86655a7acdc094b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate RSA-CRT parameters.  <a href="rsa__internal_8h.html#a97172b64cc6cc43ff86655a7acdc094b">More...</a><br /></td></tr>
<tr class="separator:a97172b64cc6cc43ff86655a7acdc094b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11973dfe48af5da179236914da637a24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa__internal_8h.html#a11973dfe48af5da179236914da637a24">mbedtls_rsa_validate_params</a> (const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *N, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *P, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *D, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *E, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a11973dfe48af5da179236914da637a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check validity of core RSA parameters.  <a href="rsa__internal_8h.html#a11973dfe48af5da179236914da637a24">More...</a><br /></td></tr>
<tr class="separator:a11973dfe48af5da179236914da637a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d8c9351383f08f161db4e0f14a7e43"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa__internal_8h.html#ae2d8c9351383f08f161db4e0f14a7e43">mbedtls_rsa_validate_crt</a> (const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *P, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *D, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *DP, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *DQ, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *QP)</td></tr>
<tr class="memdesc:ae2d8c9351383f08f161db4e0f14a7e43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check validity of RSA CRT parameters.  <a href="rsa__internal_8h.html#ae2d8c9351383f08f161db4e0f14a7e43">More...</a><br /></td></tr>
<tr class="separator:ae2d8c9351383f08f161db4e0f14a7e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module declares some RSA-related helper functions useful when implementing the RSA interface. These functions are provided in a separate compilation unit in order to make it easy for designers of alternative RSA implementations to use them in their own code, as it is conceived that the functionality they provide will be necessary for most complete implementations.</p>
<p>End-users of Mbed TLS who are not providing their own alternative RSA implementations should not use these functions directly, and should instead use only the functions declared in <a class="el" href="rsa_8h.html" title="This file provides an API for the RSA public-key cryptosystem.">rsa.h</a>.</p>
<p>The interface provided by this module will be maintained through LTS (Long Term Support) branches of Mbed TLS, but may otherwise be subject to change, and must be considered an internal interface of the library.</p>
<p>There are two classes of helper functions:</p>
<p>(1) Parameter-generating helpers. These are:</p><ul>
<li>mbedtls_rsa_deduce_primes</li>
<li>mbedtls_rsa_deduce_private_exponent</li>
<li>mbedtls_rsa_deduce_crt Each of these functions takes a set of core RSA parameters and generates some other, or CRT related parameters.</li>
</ul>
<p>(2) Parameter-checking helpers. These are:</p><ul>
<li>mbedtls_rsa_validate_params</li>
<li>mbedtls_rsa_validate_crt They take a set of core or CRT related RSA parameters and check their validity. </li>
</ul>

<p class="definition">Definition in file <a class="el" href="rsa__internal_8h_source.html">rsa_internal.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a97172b64cc6cc43ff86655a7acdc094b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97172b64cc6cc43ff86655a7acdc094b">&#9670;&nbsp;</a></span>mbedtls_rsa_deduce_crt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_rsa_deduce_crt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>DP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>DQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>QP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>This is a 'static' helper function not operating on an RSA context. Alternative implementations need not overwrite it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>First prime factor of N </td></tr>
    <tr><td class="paramname">Q</td><td>Second prime factor of N </td></tr>
    <tr><td class="paramname">D</td><td>RSA private exponent </td></tr>
    <tr><td class="paramname">DP</td><td>Output variable for D modulo P-1 </td></tr>
    <tr><td class="paramname">DQ</td><td>Output variable for D modulo Q-1 </td></tr>
    <tr><td class="paramname">QP</td><td>Output variable for the modular inverse of Q modulo P.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, non-zero error code otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function does not check whether P, Q are prime and whether D is a valid private exponent. </dd></dl>

</div>
</div>
<a id="a23ff16b5cc6b742a732256d18fcae367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23ff16b5cc6b742a732256d18fcae367">&#9670;&nbsp;</a></span>mbedtls_rsa_deduce_primes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_rsa_deduce_primes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>This is a 'static' helper function not operating on an RSA context. Alternative implementations need not overwrite it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>RSA modulus N = PQ, with P, Q to be found </td></tr>
    <tr><td class="paramname">E</td><td>RSA public exponent </td></tr>
    <tr><td class="paramname">D</td><td>RSA private exponent </td></tr>
    <tr><td class="paramname">P</td><td>Pointer to MPI holding first prime factor of N on success </td></tr>
    <tr><td class="paramname">Q</td><td>Pointer to MPI holding second prime factor of N on success</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if successful. In this case, P and Q constitute a factorization of N.</li>
<li>A non-zero error code otherwise.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is neither checked that P, Q are prime nor that D, E are modular inverses wrt. P-1 and Q-1. For that, use the helper function <code>mbedtls_rsa_validate_params</code>. </dd></dl>

</div>
</div>
<a id="a071d0f2ff7de73ddcc45fa536a39e354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071d0f2ff7de73ddcc45fa536a39e354">&#9670;&nbsp;</a></span>mbedtls_rsa_deduce_private_exponent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_rsa_deduce_private_exponent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> const *&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>This is a 'static' helper function not operating on an RSA context. Alternative implementations need not overwrite it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>First prime factor of RSA modulus </td></tr>
    <tr><td class="paramname">Q</td><td>Second prime factor of RSA modulus </td></tr>
    <tr><td class="paramname">E</td><td>RSA public exponent </td></tr>
    <tr><td class="paramname">D</td><td>Pointer to MPI holding the private exponent on success.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if successful. In this case, D is set to a simultaneous modular inverse of E modulo both P-1 and Q-1.</li>
<li>A non-zero error code otherwise.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function does not check whether P and Q are primes. </dd></dl>

</div>
</div>
<a id="ae2d8c9351383f08f161db4e0f14a7e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2d8c9351383f08f161db4e0f14a7e43">&#9670;&nbsp;</a></span>mbedtls_rsa_validate_crt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_rsa_validate_crt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>DP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>DQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>QP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>This is a 'static' helper function not operating on an RSA context. Alternative implementations need not overwrite it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>First prime factor of RSA modulus </td></tr>
    <tr><td class="paramname">Q</td><td>Second prime factor of RSA modulus </td></tr>
    <tr><td class="paramname">D</td><td>RSA private exponent </td></tr>
    <tr><td class="paramname">DP</td><td>MPI to check for D modulo P-1 </td></tr>
    <tr><td class="paramname">DQ</td><td>MPI to check for D modulo P-1 </td></tr>
    <tr><td class="paramname">QP</td><td>MPI to check for the modular inverse of Q modulo P.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the following conditions are satisfied:<ul>
<li>D = DP mod P-1 if P, D, DP != NULL</li>
<li>Q = DQ mod P-1 if P, D, DQ != NULL</li>
<li>QP = Q^-1 mod P if P, Q, QP != NULL</li>
</ul>
</li>
<li><code>MBEDTLS_ERR_RSA_KEY_CHECK_FAILED</code> if check failed, potentially including <code>MBEDTLS_ERR_MPI_XXX</code> if some MPI calculations failed.</li>
<li><code>MBEDTLS_ERR_RSA_BAD_INPUT_DATA</code> if insufficient data was provided to check DP, DQ or QP.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function can be used with a restricted set of arguments to perform specific checks only. E.g., calling it with the parameters (P, -, D, DP, -, -) will check DP = D mod P-1. </dd></dl>

</div>
</div>
<a id="a11973dfe48af5da179236914da637a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11973dfe48af5da179236914da637a24">&#9670;&nbsp;</a></span>mbedtls_rsa_validate_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_rsa_validate_params </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>This is a 'static' helper function not operating on an RSA context. Alternative implementations need not overwrite it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>RSA modulus N = PQ </td></tr>
    <tr><td class="paramname">P</td><td>First prime factor of N </td></tr>
    <tr><td class="paramname">Q</td><td>Second prime factor of N </td></tr>
    <tr><td class="paramname">D</td><td>RSA private exponent </td></tr>
    <tr><td class="paramname">E</td><td>RSA public exponent </td></tr>
    <tr><td class="paramname">f_rng</td><td>PRNG to be used for primality check, or NULL </td></tr>
    <tr><td class="paramname">p_rng</td><td>PRNG context for f_rng, or NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the following conditions are satisfied if all relevant parameters are provided:<ul>
<li>P prime if f_rng != NULL (%)</li>
<li>Q prime if f_rng != NULL (%)</li>
<li>1 &lt; N = P * Q</li>
<li>1 &lt; D, E &lt; N</li>
<li>D and E are modular inverses modulo P-1 and Q-1 (%) This is only done if MBEDTLS_GENPRIME is defined.</li>
</ul>
</li>
<li>A non-zero error code otherwise.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function can be used with a restricted set of arguments to perform specific checks only. E.g., calling it with (-,P,-,-,-) and a PRNG amounts to a primality check for P. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer">
<small>
Copyright &#169  2020 Infineon Technologies AG</a>
</small></address>
</body>
</html>
