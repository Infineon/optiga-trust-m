<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPTIGA™ Trust M  Host Library Documentation: hkdf.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DoxygenLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPTIGA™ Trust M  Host Library Documentation
   &#160;<span id="projectnumber">v3.00.2490</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hkdf_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">hkdf.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the HKDF interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="md_8h_source.html">md.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for hkdf.h:</div>
<div class="dyncontent">
<div class="center"><img src="hkdf_8h__incl.png" border="0" usemap="#ahkdf_8h" alt=""/></div>
<map name="hkdf_8h" id="hkdf_8h">
<area shape="rect" title="This file contains the HKDF interface." alt="" coords="56,5,113,32"/>
<area shape="rect" href="md_8h.html" title="This file contains the generic message&#45;digest wrapper." alt="" coords="59,80,110,107"/>
<area shape="rect" title=" " alt="" coords="5,155,73,181"/>
<area shape="rect" href="config_8h.html" title="Configuration options (set of defines)" alt="" coords="98,155,165,181"/>
</map>
</div>
</div>
<p><a href="hkdf_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
HKDF Error codes</h2></td></tr>
<tr class="memitem:a20273717e2b3b536f50b8bb9a5c91dce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hkdf_8h.html#a20273717e2b3b536f50b8bb9a5c91dce">MBEDTLS_ERR_HKDF_BAD_INPUT_DATA</a>&#160;&#160;&#160;-0x5F80</td></tr>
<tr class="separator:a20273717e2b3b536f50b8bb9a5c91dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9dfaeb0544fe502c0240c9f90618ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hkdf_8h.html#add9dfaeb0544fe502c0240c9f90618ed">mbedtls_hkdf</a> (const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *<a class="el" href="compat-1_83_8h.html#aa259673bd7996b881b0754e3d35f09b6">md</a>, const unsigned char *salt, size_t salt_len, const unsigned char *ikm, size_t ikm_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="memdesc:add9dfaeb0544fe502c0240c9f90618ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the HMAC-based Extract-and-Expand Key Derivation Function (HKDF).  <a href="hkdf_8h.html#add9dfaeb0544fe502c0240c9f90618ed">More...</a><br /></td></tr>
<tr class="separator:add9dfaeb0544fe502c0240c9f90618ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc52cb2585719ae429cd1be7e52d0a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hkdf_8h.html#accc52cb2585719ae429cd1be7e52d0a4">mbedtls_hkdf_extract</a> (const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *<a class="el" href="compat-1_83_8h.html#aa259673bd7996b881b0754e3d35f09b6">md</a>, const unsigned char *salt, size_t salt_len, const unsigned char *ikm, size_t ikm_len, unsigned char *prk)</td></tr>
<tr class="memdesc:accc52cb2585719ae429cd1be7e52d0a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take the input keying material <code>ikm</code> and extract from it a fixed-length pseudorandom key <code>prk</code>.  <a href="hkdf_8h.html#accc52cb2585719ae429cd1be7e52d0a4">More...</a><br /></td></tr>
<tr class="separator:accc52cb2585719ae429cd1be7e52d0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33043e5011a81ad50ed279f8e7d02a95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hkdf_8h.html#a33043e5011a81ad50ed279f8e7d02a95">mbedtls_hkdf_expand</a> (const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *<a class="el" href="compat-1_83_8h.html#aa259673bd7996b881b0754e3d35f09b6">md</a>, const unsigned char *prk, size_t prk_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="memdesc:a33043e5011a81ad50ed279f8e7d02a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand the supplied <code>prk</code> into several additional pseudorandom keys, which is the output of the HKDF.  <a href="hkdf_8h.html#a33043e5011a81ad50ed279f8e7d02a95">More...</a><br /></td></tr>
<tr class="separator:a33043e5011a81ad50ed279f8e7d02a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">     The HMAC-based Extract-and-Expand Key Derivation Function (HKDF) is
     specified by RFC 5869.
</pre> 
<p class="definition">Definition in file <a class="el" href="hkdf_8h_source.html">hkdf.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a20273717e2b3b536f50b8bb9a5c91dce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20273717e2b3b536f50b8bb9a5c91dce">&#9670;&nbsp;</a></span>MBEDTLS_ERR_HKDF_BAD_INPUT_DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_HKDF_BAD_INPUT_DATA&#160;&#160;&#160;-0x5F80</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bad input parameters to function. </p>

<p class="definition">Definition at line <a class="el" href="hkdf_8h_source.html#l00036">36</a> of file <a class="el" href="hkdf_8h_source.html">hkdf.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="add9dfaeb0544fe502c0240c9f90618ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9dfaeb0544fe502c0240c9f90618ed">&#9670;&nbsp;</a></span>mbedtls_hkdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ikm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ikm_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>info_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>okm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>okm_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramname">salt</td><td>An optional salt value (a non-secret random value); if the salt is not provided, a string of all zeros of md.size length is used as the salt. </td></tr>
    <tr><td class="paramname">salt_len</td><td>The length in bytes of the optional <code>salt</code>. </td></tr>
    <tr><td class="paramname">ikm</td><td>The input keying material. </td></tr>
    <tr><td class="paramname">ikm_len</td><td>The length in bytes of <code>ikm</code>. </td></tr>
    <tr><td class="paramname">info</td><td>An optional context and application specific information string. This can be a zero-length string. </td></tr>
    <tr><td class="paramname">info_len</td><td>The length of <code>info</code> in bytes. </td></tr>
    <tr><td class="paramname">okm</td><td>The output keying material of <code>okm_len</code> bytes. </td></tr>
    <tr><td class="paramname">okm_len</td><td>The length of the output keying material in bytes. This must be less than or equal to 255 * md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
<a class="el" href="hkdf_8h.html#a20273717e2b3b536f50b8bb9a5c91dce">MBEDTLS_ERR_HKDF_BAD_INPUT_DATA</a> when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>

</div>
</div>
<a id="a33043e5011a81ad50ed279f8e7d02a95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33043e5011a81ad50ed279f8e7d02a95">&#9670;&nbsp;</a></span>mbedtls_hkdf_expand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf_expand </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>prk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>prk_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>info_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>okm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>okm_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>This function should only be used if the security of it has been studied and established in that particular context (eg. TLS 1.3 key schedule). For standard HKDF security guarantees use <code>mbedtls_hkdf</code> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramname">prk</td><td>A pseudorandom key of at least md.size bytes. <code>prk</code> is usually the output from the HKDF extract step. </td></tr>
    <tr><td class="paramname">prk_len</td><td>The length in bytes of <code>prk</code>. </td></tr>
    <tr><td class="paramname">info</td><td>An optional context and application specific information string. This can be a zero-length string. </td></tr>
    <tr><td class="paramname">info_len</td><td>The length of <code>info</code> in bytes. </td></tr>
    <tr><td class="paramname">okm</td><td>The output keying material of <code>okm_len</code> bytes. </td></tr>
    <tr><td class="paramname">okm_len</td><td>The length of the output keying material in bytes. This must be less than or equal to 255 * md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
<a class="el" href="hkdf_8h.html#a20273717e2b3b536f50b8bb9a5c91dce">MBEDTLS_ERR_HKDF_BAD_INPUT_DATA</a> when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>

</div>
</div>
<a id="accc52cb2585719ae429cd1be7e52d0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc52cb2585719ae429cd1be7e52d0a4">&#9670;&nbsp;</a></span>mbedtls_hkdf_extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf_extract </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ikm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ikm_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>prk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>This function should only be used if the security of it has been studied and established in that particular context (eg. TLS 1.3 key schedule). For standard HKDF security guarantees use <code>mbedtls_hkdf</code> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">salt</td><td>An optional salt value (a non-secret random value); if the salt is not provided, a string of all zeros of md.size length is used as the salt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">salt_len</td><td>The length in bytes of the optional <code>salt</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ikm</td><td>The input keying material. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ikm_len</td><td>The length in bytes of <code>ikm</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prk</td><td>A pseudorandom key of at least md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
<a class="el" href="hkdf_8h.html#a20273717e2b3b536f50b8bb9a5c91dce">MBEDTLS_ERR_HKDF_BAD_INPUT_DATA</a> when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer">
<small>
Copyright &#169  2020 Infineon Technologies AG</a>
</small></address>
</body>
</html>
