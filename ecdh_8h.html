<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPTIGA™ Trust M  Host Library Documentation: ecdh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DoxygenLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPTIGA™ Trust M  Host Library Documentation
   &#160;<span id="projectnumber">v3.00.2490</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ecdh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ecdh.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains ECDH definitions and functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ecp_8h_source.html">ecp.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ecdh.h:</div>
<div class="dyncontent">
<div class="center"><img src="ecdh_8h__incl.png" border="0" usemap="#aecdh_8h" alt=""/></div>
<map name="ecdh_8h" id="ecdh_8h">
<area shape="rect" title="This file contains ECDH definitions and functions." alt="" coords="12,5,73,32"/>
<area shape="rect" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP)." alt="" coords="15,80,70,107"/>
<area shape="rect" href="bignum_8h.html" title="Multi&#45;precision integer library." alt="" coords="5,155,80,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ecdh_8h__dep__incl.png" border="0" usemap="#aecdh_8hdep" alt=""/></div>
<map name="ecdh_8hdep" id="ecdh_8hdep">
<area shape="rect" title="This file contains ECDH definitions and functions." alt="" coords="301,5,362,32"/>
<area shape="rect" href="ssl_8h.html" title="SSL/TLS functions." alt="" coords="306,80,357,107"/>
<area shape="rect" href="debug_8h.html" title="Functions for controlling and providing debug output from the library." alt="" coords="5,155,73,181"/>
<area shape="rect" href="net__sockets_8h.html" title="Network sockets abstraction layer to integrate Mbed TLS into a BSD&#45;style sockets API." alt="" coords="98,155,202,181"/>
<area shape="rect" href="ssl__cache_8h.html" title="SSL session cache implementation." alt="" coords="227,155,319,181"/>
<area shape="rect" href="ssl__cookie_8h.html" title="DTLS cookie callbacks implementation." alt="" coords="343,155,437,181"/>
<area shape="rect" href="ssl__internal_8h.html" title="Internal functions shared by the SSL modules." alt="" coords="462,155,561,181"/>
<area shape="rect" href="ssl__ticket_8h.html" title="TLS server ticket callbacks implementation." alt="" coords="585,155,675,181"/>
</map>
</div>
</div>
<p><a href="ecdh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <a href="structmbedtls__ecdh__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a34142af6045ce51995f621c5f7648f31"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a34142af6045ce51995f621c5f7648f31">MBEDTLS_ECDH_LEGACY_CONTEXT</a></td></tr>
<tr class="separator:a34142af6045ce51995f621c5f7648f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abbeab18d635fc3d2ae9afb941d41f4da"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#abbeab18d635fc3d2ae9afb941d41f4da">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:abbeab18d635fc3d2ae9afb941d41f4da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <a href="ecdh_8h.html#abbeab18d635fc3d2ae9afb941d41f4da">More...</a><br /></td></tr>
<tr class="separator:abbeab18d635fc3d2ae9afb941d41f4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae5df12f2068df09a102e05e02fb1e39c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> { <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>, 
<a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>
 }</td></tr>
<tr class="separator:ae5df12f2068df09a102e05e02fb1e39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a403a5d7363b6219a2017b837b665c354"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a403a5d7363b6219a2017b837b665c354">mbedtls_ecdh_gen_public</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a403a5d7363b6219a2017b837b665c354"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an ECDH keypair on an elliptic curve.  <a href="ecdh_8h.html#a403a5d7363b6219a2017b837b665c354">More...</a><br /></td></tr>
<tr class="separator:a403a5d7363b6219a2017b837b665c354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0670e79f3002a218d6da8c8dee61e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1">mbedtls_ecdh_compute_shared</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *z, const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:aca0670e79f3002a218d6da8c8dee61e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the shared secret.  <a href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1">More...</a><br /></td></tr>
<tr class="separator:aca0670e79f3002a218d6da8c8dee61e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e787a12f7aae180ab9828303199dca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a97e787a12f7aae180ab9828303199dca">mbedtls_ecdh_init</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a97e787a12f7aae180ab9828303199dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an ECDH context.  <a href="ecdh_8h.html#a97e787a12f7aae180ab9828303199dca">More...</a><br /></td></tr>
<tr class="separator:a97e787a12f7aae180ab9828303199dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc">mbedtls_ecdh_setup</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, <a class="el" href="ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> grp_id)</td></tr>
<tr class="memdesc:a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up the ECDH context with the information given.  <a href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc">More...</a><br /></td></tr>
<tr class="separator:a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a89cc40dc92fbbaf0275ea9a6184a5e71">mbedtls_ecdh_free</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function frees a context.  <a href="ecdh_8h.html#a89cc40dc92fbbaf0275ea9a6184a5e71">More...</a><br /></td></tr>
<tr class="separator:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784e56d5eea12e38374e9ce028692940"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940">mbedtls_ecdh_make_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a784e56d5eea12e38374e9ce028692940"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange handshake message.  <a href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940">More...</a><br /></td></tr>
<tr class="separator:a784e56d5eea12e38374e9ce028692940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07326ad0017bf6fcfb9f93e43641254"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254">mbedtls_ecdh_read_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char **buf, const unsigned char *end)</td></tr>
<tr class="memdesc:af07326ad0017bf6fcfb9f93e43641254"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.  <a href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254">More...</a><br /></td></tr>
<tr class="separator:af07326ad0017bf6fcfb9f93e43641254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c03b82213c39abd90a5bd4b1646441d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a3c03b82213c39abd90a5bd4b1646441d">mbedtls_ecdh_get_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *key, <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> side)</td></tr>
<tr class="memdesc:a3c03b82213c39abd90a5bd4b1646441d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up an ECDH context from an EC key.  <a href="ecdh_8h.html#a3c03b82213c39abd90a5bd4b1646441d">More...</a><br /></td></tr>
<tr class="separator:a3c03b82213c39abd90a5bd4b1646441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417fd45ce78adb1b52027f995fa5ee57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a417fd45ce78adb1b52027f995fa5ee57">mbedtls_ecdh_make_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a417fd45ce78adb1b52027f995fa5ee57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates a public key and exports it as a TLS ClientKeyExchange payload.  <a href="ecdh_8h.html#a417fd45ce78adb1b52027f995fa5ee57">More...</a><br /></td></tr>
<tr class="separator:a417fd45ce78adb1b52027f995fa5ee57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f417d90797b109d3036feb288e33207"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a9f417d90797b109d3036feb288e33207">mbedtls_ecdh_read_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char *buf, size_t blen)</td></tr>
<tr class="memdesc:a9f417d90797b109d3036feb288e33207"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses and processes the ECDHE payload of a TLS ClientKeyExchange message.  <a href="ecdh_8h.html#a9f417d90797b109d3036feb288e33207">More...</a><br /></td></tr>
<tr class="separator:a9f417d90797b109d3036feb288e33207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423fee27a0c8603bba336cbfe6dadcaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a423fee27a0c8603bba336cbfe6dadcaa">mbedtls_ecdh_calc_secret</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a423fee27a0c8603bba336cbfe6dadcaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives and exports the shared secret.  <a href="ecdh_8h.html#a423fee27a0c8603bba336cbfe6dadcaa">More...</a><br /></td></tr>
<tr class="separator:a423fee27a0c8603bba336cbfe6dadcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The Elliptic Curve Diffie-Hellman (ECDH) protocol is an anonymous key agreement protocol allowing two parties to establish a shared secret over an insecure channel. Each party must have an elliptic-curve public–private key pair.</p>
<p>For more information, see <em>NIST SP 800-56A Rev. 2: Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</em>. </p>

<p class="definition">Definition in file <a class="el" href="ecdh_8h_source.html">ecdh.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a34142af6045ce51995f621c5f7648f31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34142af6045ce51995f621c5f7648f31">&#9670;&nbsp;</a></span>MBEDTLS_ECDH_LEGACY_CONTEXT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ECDH_LEGACY_CONTEXT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecdh_8h_source.html#l00049">49</a> of file <a class="el" href="ecdh_8h_source.html">ecdh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="abbeab18d635fc3d2ae9afb941d41f4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbeab18d635fc3d2ae9afb941d41f4da">&#9670;&nbsp;</a></span>mbedtls_ecdh_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>Performing multiple operations concurrently on the same ECDSA context is not supported; objects of this type should not be shared between multiple threads. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ae5df12f2068df09a102e05e02fb1e39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5df12f2068df09a102e05e02fb1e39c">&#9670;&nbsp;</a></span>mbedtls_ecdh_side</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the source of the imported EC key. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703"></a>MBEDTLS_ECDH_OURS&#160;</td><td class="fielddoc"><p>Our key. </p>
</td></tr>
<tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb"></a>MBEDTLS_ECDH_THEIRS&#160;</td><td class="fielddoc"><p>The key of the peer. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ecdh_8h_source.html#l00058">58</a> of file <a class="el" href="ecdh_8h_source.html">ecdh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a423fee27a0c8603bba336cbfe6dadcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a423fee27a0c8603bba336cbfe6dadcaa">&#9670;&nbsp;</a></span>mbedtls_ecdh_calc_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_calc_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">             This is the last function used by both TLS client
             and servers.
</pre><dl class="section note"><dt>Note</dt><dd>If <code>f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and have its own private key generated and the peer's public key imported. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the total number of Bytes written on success. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The buffer to write the generated shared key to. This must be a writable buffer of size <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function, for blinding purposes. This may b <code>NULL</code> if blinding isn't needed. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context. This may be <code>NULL</code> if <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="aca0670e79f3002a218d6da8c8dee61e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0670e79f3002a218d6da8c8dee61e1">&#9670;&nbsp;</a></span>mbedtls_ecdh_compute_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_compute_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">             This function performs the second of two core computations
             implemented during the ECDH key exchange. The first core
             computation is performed by mbedtls_ecdh_gen_public().
</pre><dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>If <code>f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="ecp_8h.html#acfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">z</td><td>The destination MPI (shared secret). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The public key from another party. This must be initialized. </td></tr>
    <tr><td class="paramname">d</td><td>Our secret exponent (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function. This may be <code>NULL</code> if randomization of intermediate results during the ECP computations is not needed (discouraged). See the documentation of <a class="el" href="ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a> for more. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> if <code>f_rng</code> is <code>NULL</code> or doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a89cc40dc92fbbaf0275ea9a6184a5e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cc40dc92fbbaf0275ea9a6184a5e71">&#9670;&nbsp;</a></span>mbedtls_ecdh_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The context to free. This may be <code>NULL</code>, in which case this function does nothing. If it is not <code>NULL</code>, it must point to an initialized ECDH context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a403a5d7363b6219a2017b837b665c354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a403a5d7363b6219a2017b837b665c354">&#9670;&nbsp;</a></span>mbedtls_ecdh_gen_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_gen_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function performs the first of two core computations implemented during the ECDH key exchange. The second core computation is performed by <a class="el" href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1" title="This function computes the shared secret.">mbedtls_ecdh_compute_shared()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="ecp_8h.html#acfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">d</td><td>The destination MPI (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The destination point (public key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a3c03b82213c39abd90a5bd4b1646441d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c03b82213c39abd90a5bd4b1646441d">&#9670;&nbsp;</a></span>mbedtls_ecdh_get_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_get_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a>&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">             It is used by clients and servers in place of the
             ServerKeyEchange for static ECDH, and imports ECDH
             parameters from the EC key information of a certificate.
</pre><dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">key</td><td>The EC key to use. This must be initialized. </td></tr>
    <tr><td class="paramname">side</td><td>Defines the source of the key. Possible values are:<ul>
<li><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>: The key is ours.</li>
<li><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>: The key is that of the peer.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a97e787a12f7aae180ab9828303199dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e787a12f7aae180ab9828303199dca">&#9670;&nbsp;</a></span>mbedtls_ecdh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to initialize. This must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a784e56d5eea12e38374e9ce028692940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784e56d5eea12e38374e9ce028692940">&#9670;&nbsp;</a></span>mbedtls_ecdh_make_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the second function used by a TLS server for ECDHE ciphersuites. (It is called after <a class="el" href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a417fd45ce78adb1b52027f995fa5ee57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a417fd45ce78adb1b52027f995fa5ee57">&#9670;&nbsp;</a></span>mbedtls_ecdh_make_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the second function used by a TLS client for ECDH(E) ciphersuites.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, the latter usually by <a class="el" href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The size of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="af07326ad0017bf6fcfb9f93e43641254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07326ad0017bf6fcfb9f93e43641254">&#9670;&nbsp;</a></span>mbedtls_ecdh_read_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>In a TLS handshake, this is the how the client sets up its ECDHE context from the server's public ECDHE key material.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDHE context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">buf</td><td>On input, <code>*buf</code> must be the start of the input buffer. On output, <code>*buf</code> is updated to point to the end of the data that has been read. On success, this is the first byte past the end of the ServerKeyExchange parameters. On error, this is the point at which an error has been detected, which is usually not useful except to debug failures. </td></tr>
    <tr><td class="paramname">end</td><td>The end of the input buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a9f417d90797b109d3036feb288e33207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f417d90797b109d3036feb288e33207">&#9670;&nbsp;</a></span>mbedtls_ecdh_read_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the third function used by a TLS server for ECDH(E) ciphersuites. (It is called after <a class="el" href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a> and <a class="el" href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ecp_8h.html" title="This file provides an API for Elliptic Curves over GF(P) (ECP).">ecp.h</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="ecdh_8h.html#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">buf</td><td>The pointer to the ClientKeyExchange payload. This must be a readable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the input buffer <code>buf</code> in Bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a296f6ce7b1b8b53d048a6c28ff3420cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296f6ce7b1b8b53d048a6c28ff3420cc">&#9670;&nbsp;</a></span>mbedtls_ecdh_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a>&#160;</td>
          <td class="paramname"><em>grp_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function should be called after <a class="el" href="ecdh_8h.html#a97e787a12f7aae180ab9828303199dca" title="This function initializes an ECDH context.">mbedtls_ecdh_init()</a> but before <a class="el" href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>. There is no need to call this function before <a class="el" href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>.</p>
<p>This is the first function used by a TLS server for ECDHE ciphersuites.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">grp_id</td><td>The group id of the group to set up the context for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer">
<small>
Copyright &#169  2020 Infineon Technologies AG</a>
</small></address>
</body>
</html>
