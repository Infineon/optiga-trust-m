<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPTIGA™ Trust M: optiga_crypt.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IFX_LOGO_RGB.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPTIGA™ Trust M
   </div>
   <div id="projectbrief">Host Library Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('optiga__crypt_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">optiga_crypt.h File Reference<div class="ingroups"><a class="el" href="group__grOptigaCrypt.html">OPTIGA Crypt</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This file implements the prototype declarations of OPTIGA Crypt module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="optiga__cmd_8h_source.html">optiga/cmd/optiga_cmd.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for optiga_crypt.h:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h__incl.png" border="0" usemap="#aoptiga__crypt_8h" alt=""/></div>
<map name="optiga__crypt_8h" id="optiga__crypt_8h">
<area shape="rect" title="This file implements the prototype declarations of OPTIGA Crypt module." alt="" coords="37,5,141,32"/>
<area shape="rect" href="optiga__cmd_8h.html" title="This file defines APIs, types and data structures used in the Command (cmd) module implementation." alt="" coords="5,80,173,107"/>
<area shape="rect" href="optiga__lib__common_8h.html" title="This file provides the prototypes for the commonly used functions and structures of OPTIGA Library." alt="" coords="14,155,165,196"/>
</map>
</div>
</div>
<p><a href="optiga__crypt_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionoptiga__crypt__params.html">optiga_crypt_params</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">union for OPTIGA crypt parameters  <a href="unionoptiga__crypt__params.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structoptiga__crypt.html">optiga_crypt</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">OPTIGA crypt instance structure.  <a href="structoptiga__crypt.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153e3456437ee829b88d638d301a744"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>(p_instance,  protection_level)&#160;&#160;&#160;{}</td></tr>
<tr class="memdesc:a6153e3456437ee829b88d638d301a744"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the protected I2C communication with OPTIGA for CRYPT instances.  <a href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744">More...</a><br /></td></tr>
<tr class="separator:a6153e3456437ee829b88d638d301a744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7134573dc358ee6b6ef255b8feb4d9b9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a7134573dc358ee6b6ef255b8feb4d9b9">OPTIGA_CRYPT_SET_COMMS_PROTOCOL_VERSION</a>(p_instance,  version)&#160;&#160;&#160;{}</td></tr>
<tr class="memdesc:a7134573dc358ee6b6ef255b8feb4d9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select the protocol version required for the I2C protected communication for CRYPT instances.  <a href="optiga__crypt_8h.html#a7134573dc358ee6b6ef255b8feb4d9b9">More...</a><br /></td></tr>
<tr class="separator:a7134573dc358ee6b6ef255b8feb4d9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb7cbc8e36d504f5b29d7a82f41fc9f7"><td class="memItemLeft" align="right" valign="top">typedef union <a class="el" href="unionoptiga__crypt__params.html">optiga_crypt_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#acb7cbc8e36d504f5b29d7a82f41fc9f7">optiga_crypt_params_t</a></td></tr>
<tr class="memdesc:acb7cbc8e36d504f5b29d7a82f41fc9f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">union for OPTIGA crypt parameters  <a href="optiga__crypt_8h.html#acb7cbc8e36d504f5b29d7a82f41fc9f7">More...</a><br /></td></tr>
<tr class="separator:acb7cbc8e36d504f5b29d7a82f41fc9f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba51e25e66ba8f1a8c9a0d664ce05ddb"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structoptiga__crypt.html">optiga_crypt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a></td></tr>
<tr class="memdesc:aba51e25e66ba8f1a8c9a0d664ce05ddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">OPTIGA crypt instance structure type.  <a href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">More...</a><br /></td></tr>
<tr class="separator:aba51e25e66ba8f1a8c9a0d664ce05ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa704c4dce67d7fcd2a2ba9f8a8e68f84"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84">optiga_crypt_create</a> (uint8_t optiga_instance_id, <a class="el" href="optiga__lib__types_8h.html#a21dfbe8aba0ab5d12ed647269e64e59f">callback_handler_t</a> handler, void *caller_context)</td></tr>
<tr class="memdesc:aa704c4dce67d7fcd2a2ba9f8a8e68f84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>.  <a href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84">More...</a><br /></td></tr>
<tr class="separator:aa704c4dce67d7fcd2a2ba9f8a8e68f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab15b091ec91fec61011a44f7c6385d1d"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ab15b091ec91fec61011a44f7c6385d1d">optiga_crypt_destroy</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me)</td></tr>
<tr class="memdesc:ab15b091ec91fec61011a44f7c6385d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys an instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>.  <a href="optiga__crypt_8h.html#ab15b091ec91fec61011a44f7c6385d1d">More...</a><br /></td></tr>
<tr class="separator:ab15b091ec91fec61011a44f7c6385d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008ddc10a1cffed620f2b8e71b21fc55"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a008ddc10a1cffed620f2b8e71b21fc55">optiga_crypt_random</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a39ff1bc194d378852ec0d70e3f411d17">optiga_rng_type_t</a> rng_type, uint8_t *random_data, uint16_t random_data_length)</td></tr>
<tr class="memdesc:a008ddc10a1cffed620f2b8e71b21fc55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random number.  <a href="optiga__crypt_8h.html#a008ddc10a1cffed620f2b8e71b21fc55">More...</a><br /></td></tr>
<tr class="separator:a008ddc10a1cffed620f2b8e71b21fc55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0b45b49d78f06983764d2e1e75d11f"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a7f0b45b49d78f06983764d2e1e75d11f">optiga_crypt_hash</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#abaf8b33ec5d8cad61205a8592f93700a">optiga_hash_type_t</a> hash_algorithm, uint8_t source_of_data_to_hash, const void *data_to_hash, uint8_t *hash_output)</td></tr>
<tr class="memdesc:a7f0b45b49d78f06983764d2e1e75d11f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a hashing for input data and returns digest.  <a href="optiga__crypt_8h.html#a7f0b45b49d78f06983764d2e1e75d11f">More...</a><br /></td></tr>
<tr class="separator:a7f0b45b49d78f06983764d2e1e75d11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c436818097a4a2a391a0e71fdf4847"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#af4c436818097a4a2a391a0e71fdf4847">optiga_crypt_hash_start</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *hash_ctx)</td></tr>
<tr class="memdesc:af4c436818097a4a2a391a0e71fdf4847"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a hash context.  <a href="optiga__crypt_8h.html#af4c436818097a4a2a391a0e71fdf4847">More...</a><br /></td></tr>
<tr class="separator:af4c436818097a4a2a391a0e71fdf4847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98132f20df82af9d36c3c0e7f4d83242"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a98132f20df82af9d36c3c0e7f4d83242">optiga_crypt_hash_update</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *hash_ctx, uint8_t source_of_data_to_hash, const void *data_to_hash)</td></tr>
<tr class="memdesc:a98132f20df82af9d36c3c0e7f4d83242"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a hash context with the input data.  <a href="optiga__crypt_8h.html#a98132f20df82af9d36c3c0e7f4d83242">More...</a><br /></td></tr>
<tr class="separator:a98132f20df82af9d36c3c0e7f4d83242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af437164f915a17a8a39958c8e8ece092"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#af437164f915a17a8a39958c8e8ece092">optiga_crypt_hash_finalize</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *hash_ctx, uint8_t *hash_output)</td></tr>
<tr class="memdesc:af437164f915a17a8a39958c8e8ece092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes and exports the hash output.  <a href="optiga__crypt_8h.html#af437164f915a17a8a39958c8e8ece092">More...</a><br /></td></tr>
<tr class="separator:af437164f915a17a8a39958c8e8ece092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a960387f95d10c5987e18b8eb67ca6197"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a960387f95d10c5987e18b8eb67ca6197">optiga_crypt_ecc_generate_keypair</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a270ba3f6c8c22bbe572713bbf85deb1d">optiga_ecc_curve_t</a> curve_id, uint8_t <a class="el" href="protected__update__data__set_8h.html#a5a703de2b0840a0fb3463132f8b0b8a1">key_usage</a>, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_private_key, void *private_key, uint8_t *public_key, uint16_t *public_key_length)</td></tr>
<tr class="memdesc:a960387f95d10c5987e18b8eb67ca6197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a key pair based on ECC curves.  <a href="optiga__crypt_8h.html#a960387f95d10c5987e18b8eb67ca6197">More...</a><br /></td></tr>
<tr class="separator:a960387f95d10c5987e18b8eb67ca6197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f04d48ff9e3a9fab8c887878464ec94"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a9f04d48ff9e3a9fab8c887878464ec94">optiga_crypt_ecdsa_sign</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *digest, uint8_t digest_length, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> private_key, uint8_t *signature, uint16_t *signature_length)</td></tr>
<tr class="memdesc:a9f04d48ff9e3a9fab8c887878464ec94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a signature for the given digest.  <a href="optiga__crypt_8h.html#a9f04d48ff9e3a9fab8c887878464ec94">More...</a><br /></td></tr>
<tr class="separator:a9f04d48ff9e3a9fab8c887878464ec94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac336a4e5caf1cd962f101a27ee88dd19"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ac336a4e5caf1cd962f101a27ee88dd19">optiga_crypt_ecdsa_verify</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *digest, uint8_t digest_length, const uint8_t *signature, uint16_t signature_length, uint8_t public_key_source_type, const void *public_key)</td></tr>
<tr class="memdesc:ac336a4e5caf1cd962f101a27ee88dd19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the signature over the given digest.  <a href="optiga__crypt_8h.html#ac336a4e5caf1cd962f101a27ee88dd19">More...</a><br /></td></tr>
<tr class="separator:ac336a4e5caf1cd962f101a27ee88dd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b0ea46c7efe418f1bd88039c9fe07b4"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4">optiga_crypt_ecdh</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> private_key, <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5">public_key_from_host_t</a> *public_key, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *shared_secret)</td></tr>
<tr class="memdesc:a6b0ea46c7efe418f1bd88039c9fe07b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the shared secret using ECDH algorithm.<br  />
  <a href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4">More...</a><br /></td></tr>
<tr class="separator:a6b0ea46c7efe418f1bd88039c9fe07b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88dedcdc999e9c558c1943650fb1694"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#af88dedcdc999e9c558c1943650fb1694">optiga_crypt_tls_prf</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a66d576ae92488b491859a7b949d8420b">optiga_tls_prf_type_t</a> type, uint16_t secret, const uint8_t *label, uint16_t label_length, const uint8_t *seed, uint16_t seed_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:af88dedcdc999e9c558c1943650fb1694"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key.<br  />
  <a href="optiga__crypt_8h.html#af88dedcdc999e9c558c1943650fb1694">More...</a><br /></td></tr>
<tr class="separator:af88dedcdc999e9c558c1943650fb1694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a928923b3560515585990a627c0e32714"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a928923b3560515585990a627c0e32714">optiga_crypt_tls_prf_sha256</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *label, uint16_t label_length, const uint8_t *seed, uint16_t seed_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:a928923b3560515585990a627c0e32714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key using TLS PRF SHA256.<br  />
  <a href="optiga__crypt_8h.html#a928923b3560515585990a627c0e32714">More...</a><br /></td></tr>
<tr class="separator:a928923b3560515585990a627c0e32714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8273f7f0a9809209ab195d990ed5bfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ab8273f7f0a9809209ab195d990ed5bfc">optiga_crypt_tls_prf_sha384</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *label, uint16_t label_length, const uint8_t *seed, uint16_t seed_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:ab8273f7f0a9809209ab195d990ed5bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key using TLS PRF SHA384.<br  />
  <a href="optiga__crypt_8h.html#ab8273f7f0a9809209ab195d990ed5bfc">More...</a><br /></td></tr>
<tr class="separator:ab8273f7f0a9809209ab195d990ed5bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e291e90a24c92f2da49ff122fa2d47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ab8e291e90a24c92f2da49ff122fa2d47">optiga_crypt_tls_prf_sha512</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *label, uint16_t label_length, const uint8_t *seed, uint16_t seed_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:ab8e291e90a24c92f2da49ff122fa2d47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key using TLS PRF SHA512.<br  />
  <a href="optiga__crypt_8h.html#ab8e291e90a24c92f2da49ff122fa2d47">More...</a><br /></td></tr>
<tr class="separator:ab8e291e90a24c92f2da49ff122fa2d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b645d8c9df6c84e40c27170cc9a8de7"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a5b645d8c9df6c84e40c27170cc9a8de7">optiga_crypt_rsa_generate_keypair</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a05eae1b76c2aea0a97b883b26e9eb220">optiga_rsa_key_type_t</a> <a class="el" href="protected__update__data__set_8h.html#ab56b05c2bb34d1168dc2576c83a1e287">key_type</a>, uint8_t <a class="el" href="protected__update__data__set_8h.html#a5a703de2b0840a0fb3463132f8b0b8a1">key_usage</a>, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_private_key, void *private_key, uint8_t *public_key, uint16_t *public_key_length)</td></tr>
<tr class="memdesc:a5b645d8c9df6c84e40c27170cc9a8de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a key pair based on RSA key type.  <a href="optiga__crypt_8h.html#a5b645d8c9df6c84e40c27170cc9a8de7">More...</a><br /></td></tr>
<tr class="separator:a5b645d8c9df6c84e40c27170cc9a8de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7942e2997506ec473624e80b70c1926"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#aa7942e2997506ec473624e80b70c1926">optiga_crypt_rsa_sign</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2">optiga_rsa_signature_scheme_t</a> signature_scheme, const uint8_t *digest, uint8_t digest_length, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> private_key, uint8_t *signature, uint16_t *signature_length, uint16_t salt_length)</td></tr>
<tr class="memdesc:aa7942e2997506ec473624e80b70c1926"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a RSA signature for the given digest based on the input signature scheme.  <a href="optiga__crypt_8h.html#aa7942e2997506ec473624e80b70c1926">More...</a><br /></td></tr>
<tr class="separator:aa7942e2997506ec473624e80b70c1926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0ce1f3f449a1436d8e7071247b4d5c"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#add0ce1f3f449a1436d8e7071247b4d5c">optiga_crypt_rsa_verify</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2">optiga_rsa_signature_scheme_t</a> signature_scheme, const uint8_t *digest, uint8_t digest_length, const uint8_t *signature, uint16_t signature_length, uint8_t public_key_source_type, const void *public_key, uint16_t salt_length)</td></tr>
<tr class="memdesc:add0ce1f3f449a1436d8e7071247b4d5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the RSA signature over the given digest.  <a href="optiga__crypt_8h.html#add0ce1f3f449a1436d8e7071247b4d5c">More...</a><br /></td></tr>
<tr class="separator:add0ce1f3f449a1436d8e7071247b4d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49aa659f73e4a77814a2ded710ddb896"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a49aa659f73e4a77814a2ded710ddb896">optiga_crypt_rsa_generate_pre_master_secret</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *optional_data, uint16_t optional_data_length, uint16_t pre_master_secret_length)</td></tr>
<tr class="memdesc:a49aa659f73e4a77814a2ded710ddb896"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a pre-master secret.  <a href="optiga__crypt_8h.html#a49aa659f73e4a77814a2ded710ddb896">More...</a><br /></td></tr>
<tr class="separator:a49aa659f73e4a77814a2ded710ddb896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1757863bc1dd0191d41a10a360d728f"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ae1757863bc1dd0191d41a10a360d728f">optiga_crypt_rsa_encrypt_message</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a> encryption_scheme, const uint8_t *message, uint16_t message_length, const uint8_t *label, uint16_t label_length, uint8_t public_key_source_type, const void *public_key, uint8_t *encrypted_message, uint16_t *encrypted_message_length)</td></tr>
<tr class="memdesc:ae1757863bc1dd0191d41a10a360d728f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts message using RSA public key.<br  />
  <a href="optiga__crypt_8h.html#ae1757863bc1dd0191d41a10a360d728f">More...</a><br /></td></tr>
<tr class="separator:ae1757863bc1dd0191d41a10a360d728f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8bfac9583be02daf34a9b7d8004ff3"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a3e8bfac9583be02daf34a9b7d8004ff3">optiga_crypt_rsa_encrypt_session</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a> encryption_scheme, const uint8_t *label, uint16_t label_length, uint8_t public_key_source_type, const void *public_key, uint8_t *encrypted_message, uint16_t *encrypted_message_length)</td></tr>
<tr class="memdesc:a3e8bfac9583be02daf34a9b7d8004ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts session data using RSA public key.<br  />
  <a href="optiga__crypt_8h.html#a3e8bfac9583be02daf34a9b7d8004ff3">More...</a><br /></td></tr>
<tr class="separator:a3e8bfac9583be02daf34a9b7d8004ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a392dbf9efe92a6f3f03a1696e15fd382"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a392dbf9efe92a6f3f03a1696e15fd382">optiga_crypt_rsa_decrypt_and_export</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a> encryption_scheme, const uint8_t *encrypted_message, uint16_t encrypted_message_length, const uint8_t *label, uint16_t label_length, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> private_key, uint8_t *message, uint16_t *message_length)</td></tr>
<tr class="memdesc:a392dbf9efe92a6f3f03a1696e15fd382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts input data using OPTIGA private key and export it to the host.<br  />
  <a href="optiga__crypt_8h.html#a392dbf9efe92a6f3f03a1696e15fd382">More...</a><br /></td></tr>
<tr class="separator:a392dbf9efe92a6f3f03a1696e15fd382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab304f6b4eed50a2455069f2f27824a92"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ab304f6b4eed50a2455069f2f27824a92">optiga_crypt_rsa_decrypt_and_store</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a> encryption_scheme, const uint8_t *encrypted_message, uint16_t encrypted_message_length, const uint8_t *label, uint16_t label_length, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> private_key)</td></tr>
<tr class="memdesc:ab304f6b4eed50a2455069f2f27824a92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts input data using OPTIGA private key and stores it in a OPTIGA session.<br  />
  <a href="optiga__crypt_8h.html#ab304f6b4eed50a2455069f2f27824a92">More...</a><br /></td></tr>
<tr class="separator:ab304f6b4eed50a2455069f2f27824a92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0517f94ee9043996c937725dadfa075"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#ac0517f94ee9043996c937725dadfa075">optiga_crypt_symmetric_encrypt</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a> encryption_mode, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *plain_data, uint32_t plain_data_length, const uint8_t *iv, uint16_t iv_length, const uint8_t *associated_data, uint16_t associated_data_length, uint8_t *encrypted_data, uint32_t *encrypted_data_length)</td></tr>
<tr class="memdesc:ac0517f94ee9043996c937725dadfa075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt the data using symmetric encryption mode and export encrypted message to host.<br  />
  <a href="optiga__crypt_8h.html#ac0517f94ee9043996c937725dadfa075">More...</a><br /></td></tr>
<tr class="separator:ac0517f94ee9043996c937725dadfa075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30cec707dd0be9ffb5b0c3255e3ee392"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a30cec707dd0be9ffb5b0c3255e3ee392">optiga_crypt_symmetric_encrypt_ecb</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *plain_data, uint32_t plain_data_length, uint8_t *encrypted_data, uint32_t *encrypted_data_length)</td></tr>
<tr class="memdesc:a30cec707dd0be9ffb5b0c3255e3ee392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
  <a href="optiga__crypt_8h.html#a30cec707dd0be9ffb5b0c3255e3ee392">More...</a><br /></td></tr>
<tr class="separator:a30cec707dd0be9ffb5b0c3255e3ee392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea6db1ceeb5610470c46474c0d3b833"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833">optiga_crypt_symmetric_encrypt_start</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a> encryption_mode, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *plain_data, uint32_t plain_data_length, const uint8_t *iv, uint16_t iv_length, const uint8_t *associated_data, uint16_t associated_data_length, uint16_t total_plain_data_length, uint8_t *encrypted_data, uint32_t *encrypted_data_length)</td></tr>
<tr class="memdesc:adea6db1ceeb5610470c46474c0d3b833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833">More...</a><br /></td></tr>
<tr class="separator:adea6db1ceeb5610470c46474c0d3b833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495d4acb6f012a3893fbb54a1ec5f424"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a495d4acb6f012a3893fbb54a1ec5f424">optiga_crypt_symmetric_encrypt_continue</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *plain_data, uint32_t plain_data_length, uint8_t *encrypted_data, uint32_t *encrypted_data_length)</td></tr>
<tr class="memdesc:a495d4acb6f012a3893fbb54a1ec5f424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts input data using symmetric key from OPTIGA and exports block aligned encrypted data.<br  />
  <a href="optiga__crypt_8h.html#a495d4acb6f012a3893fbb54a1ec5f424">More...</a><br /></td></tr>
<tr class="separator:a495d4acb6f012a3893fbb54a1ec5f424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d54487694f06de30c69238e91cbfa2d"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a0d54487694f06de30c69238e91cbfa2d">optiga_crypt_symmetric_encrypt_final</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *plain_data, uint32_t plain_data_length, uint8_t *encrypted_data, uint32_t *encrypted_data_length)</td></tr>
<tr class="memdesc:a0d54487694f06de30c69238e91cbfa2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts input data using symmetric key from OPTIGA, exports block aligned encrypted data and completes the encryption sequence.<br  />
  <a href="optiga__crypt_8h.html#a0d54487694f06de30c69238e91cbfa2d">More...</a><br /></td></tr>
<tr class="separator:a0d54487694f06de30c69238e91cbfa2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4940ec40b71d64a6253a01b36aff11c6"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a4940ec40b71d64a6253a01b36aff11c6">optiga_crypt_symmetric_decrypt</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a> encryption_mode, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *encrypted_data, uint32_t encrypted_data_length, const uint8_t *iv, uint16_t iv_length, const uint8_t *associated_data, uint16_t associated_data_length, uint8_t *plain_data, uint32_t *plain_data_length)</td></tr>
<tr class="memdesc:a4940ec40b71d64a6253a01b36aff11c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt the encrypted data using symmetric encryption mode and export plain message to host.<br  />
  <a href="optiga__crypt_8h.html#a4940ec40b71d64a6253a01b36aff11c6">More...</a><br /></td></tr>
<tr class="separator:a4940ec40b71d64a6253a01b36aff11c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0dc98b43e7c825f6bb358c2f0bdc5d"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a6f0dc98b43e7c825f6bb358c2f0bdc5d">optiga_crypt_symmetric_decrypt_ecb</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *encrypted_data, uint32_t encrypted_data_length, uint8_t *plain_data, uint32_t *plain_data_length)</td></tr>
<tr class="memdesc:a6f0dc98b43e7c825f6bb358c2f0bdc5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
  <a href="optiga__crypt_8h.html#a6f0dc98b43e7c825f6bb358c2f0bdc5d">More...</a><br /></td></tr>
<tr class="separator:a6f0dc98b43e7c825f6bb358c2f0bdc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b7cead52fda89f0d0a1c0c9cb55f8c"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c">optiga_crypt_symmetric_decrypt_start</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a> encryption_mode, <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a> symmetric_key_oid, const uint8_t *encrypted_data, uint32_t encrypted_data_length, const uint8_t *iv, uint16_t iv_length, const uint8_t *associated_data, uint16_t associated_data_length, uint16_t total_encrypted_data_length, uint8_t *plain_data, uint32_t *plain_data_length)</td></tr>
<tr class="memdesc:a96b7cead52fda89f0d0a1c0c9cb55f8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c">More...</a><br /></td></tr>
<tr class="separator:a96b7cead52fda89f0d0a1c0c9cb55f8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6038c7caf4d1ed90e7c50257fa6d695e"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a6038c7caf4d1ed90e7c50257fa6d695e">optiga_crypt_symmetric_decrypt_continue</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *encrypted_data, uint32_t encrypted_data_length, uint8_t *plain_data, uint32_t *plain_data_length)</td></tr>
<tr class="memdesc:a6038c7caf4d1ed90e7c50257fa6d695e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts input encrypted data using symmetric key from OPTIGA and exports block aligned plain data.<br  />
  <a href="optiga__crypt_8h.html#a6038c7caf4d1ed90e7c50257fa6d695e">More...</a><br /></td></tr>
<tr class="separator:a6038c7caf4d1ed90e7c50257fa6d695e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0942b29f35aed3b78f59382efdc673ba"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a0942b29f35aed3b78f59382efdc673ba">optiga_crypt_symmetric_decrypt_final</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *encrypted_data, uint32_t encrypted_data_length, uint8_t *plain_data, uint32_t *plain_data_length)</td></tr>
<tr class="memdesc:a0942b29f35aed3b78f59382efdc673ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts input data using symmetric key from OPTIGA, exports block aligned plain data and completes the decryption sequence.<br  />
  <a href="optiga__crypt_8h.html#a0942b29f35aed3b78f59382efdc673ba">More...</a><br /></td></tr>
<tr class="separator:a0942b29f35aed3b78f59382efdc673ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d236cbe1ebc6a28e333e011a98e661"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a56d236cbe1ebc6a28e333e011a98e661">optiga_crypt_hmac</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a> type, uint16_t secret, const uint8_t *input_data, uint32_t input_data_length, uint8_t *mac, uint32_t *mac_length)</td></tr>
<tr class="memdesc:a56d236cbe1ebc6a28e333e011a98e661"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates HMAC on the input message using input secret from OPTIGA and exports the generated HMAC to the host.<br  />
  <a href="optiga__crypt_8h.html#a56d236cbe1ebc6a28e333e011a98e661">More...</a><br /></td></tr>
<tr class="separator:a56d236cbe1ebc6a28e333e011a98e661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a321997c63b9d4ace67d9e974b08cd229"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229">optiga_crypt_hmac_start</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a> type, uint16_t secret, const uint8_t *input_data, uint32_t input_data_length)</td></tr>
<tr class="memdesc:a321997c63b9d4ace67d9e974b08cd229"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229">More...</a><br /></td></tr>
<tr class="separator:a321997c63b9d4ace67d9e974b08cd229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995035c7ab4b47aacc9bc7216961bb3e"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a995035c7ab4b47aacc9bc7216961bb3e">optiga_crypt_hmac_update</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *input_data, uint32_t input_data_length)</td></tr>
<tr class="memdesc:a995035c7ab4b47aacc9bc7216961bb3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates HMAC on the input message using input secret from OPTIGA, update the previously generated HMAC value internally.<br  />
  <a href="optiga__crypt_8h.html#a995035c7ab4b47aacc9bc7216961bb3e">More...</a><br /></td></tr>
<tr class="separator:a995035c7ab4b47aacc9bc7216961bb3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c13f6a51f7a0707b9612b7ed55bb359"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a9c13f6a51f7a0707b9612b7ed55bb359">optiga_crypt_hmac_finalize</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, const uint8_t *input_data, uint32_t input_data_length, uint8_t *mac, uint32_t *mac_length)</td></tr>
<tr class="memdesc:a9c13f6a51f7a0707b9612b7ed55bb359"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates HMAC on the input message using input secret from OPTIGA and exports the finalized HMAC to host.<br  />
  <a href="optiga__crypt_8h.html#a9c13f6a51f7a0707b9612b7ed55bb359">More...</a><br /></td></tr>
<tr class="separator:a9c13f6a51f7a0707b9612b7ed55bb359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e09748f1a0601251739b883be03596c"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a1e09748f1a0601251739b883be03596c">optiga_crypt_hkdf</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a86002cbbdbacbc858fddbe262c03e66f">optiga_hkdf_type_t</a> type, uint16_t secret, const uint8_t *salt, uint16_t salt_length, const uint8_t *info, uint16_t info_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:a1e09748f1a0601251739b883be03596c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a1e09748f1a0601251739b883be03596c">More...</a><br /></td></tr>
<tr class="separator:a1e09748f1a0601251739b883be03596c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d46466b1afc2d6019a5667a88f9fcd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a66d46466b1afc2d6019a5667a88f9fcd">optiga_crypt_hkdf_sha256</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *salt, uint16_t salt_length, const uint8_t *info, uint16_t info_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:a66d46466b1afc2d6019a5667a88f9fcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key or shared secret using HKDF-SHA256 operation from the secret stored in OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a66d46466b1afc2d6019a5667a88f9fcd">More...</a><br /></td></tr>
<tr class="separator:a66d46466b1afc2d6019a5667a88f9fcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7f6787b5a9e8d15992b0058eec7901"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a9b7f6787b5a9e8d15992b0058eec7901">optiga_crypt_hkdf_sha384</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *salt, uint16_t salt_length, const uint8_t *info, uint16_t info_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:a9b7f6787b5a9e8d15992b0058eec7901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key or shared secret using HKDF-SHA384 operation from the secret stored in OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a9b7f6787b5a9e8d15992b0058eec7901">More...</a><br /></td></tr>
<tr class="separator:a9b7f6787b5a9e8d15992b0058eec7901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addaa20d04f272886e8090ca34cbdf406"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#addaa20d04f272886e8090ca34cbdf406">optiga_crypt_hkdf_sha512</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret, const uint8_t *salt, uint16_t salt_length, const uint8_t *info, uint16_t info_length, uint16_t derived_key_length, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_to_host, uint8_t *derived_key)</td></tr>
<tr class="memdesc:addaa20d04f272886e8090ca34cbdf406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key or shared secret using HKDF-SHA512 operation from the secret stored in OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#addaa20d04f272886e8090ca34cbdf406">More...</a><br /></td></tr>
<tr class="separator:addaa20d04f272886e8090ca34cbdf406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24a46bd4b29fd58b678f616ab092bdc3"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a24a46bd4b29fd58b678f616ab092bdc3">optiga_crypt_symmetric_generate_key</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a315e9ccb8ae245086225762cbadc7684">optiga_symmetric_key_type_t</a> <a class="el" href="protected__update__data__set_8h.html#ab56b05c2bb34d1168dc2576c83a1e287">key_type</a>, uint8_t <a class="el" href="protected__update__data__set_8h.html#a5a703de2b0840a0fb3463132f8b0b8a1">key_usage</a>, <a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a> export_symmetric_key, void *symmetric_key)</td></tr>
<tr class="memdesc:a24a46bd4b29fd58b678f616ab092bdc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a symmetric key using OPTIGA.  <a href="optiga__crypt_8h.html#a24a46bd4b29fd58b678f616ab092bdc3">More...</a><br /></td></tr>
<tr class="separator:a24a46bd4b29fd58b678f616ab092bdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6ec5dae6a50a2c8eb5c270d4071add"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a1e6ec5dae6a50a2c8eb5c270d4071add">optiga_crypt_generate_auth_code</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a39ff1bc194d378852ec0d70e3f411d17">optiga_rng_type_t</a> rng_type, const uint8_t *optional_data, uint16_t optional_data_length, uint8_t *random_data, uint16_t random_data_length)</td></tr>
<tr class="memdesc:a1e6ec5dae6a50a2c8eb5c270d4071add"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random number using OPTIGA and stores the same in acquired session context at OPTIGA.  <a href="optiga__crypt_8h.html#a1e6ec5dae6a50a2c8eb5c270d4071add">More...</a><br /></td></tr>
<tr class="separator:a1e6ec5dae6a50a2c8eb5c270d4071add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5847c76c9c2c30a702f897be2ab5bd27"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#a5847c76c9c2c30a702f897be2ab5bd27">optiga_crypt_hmac_verify</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, <a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a> type, uint16_t secret, const uint8_t *input_data, uint32_t input_data_length, const uint8_t *hmac, uint32_t hmac_length)</td></tr>
<tr class="memdesc:a5847c76c9c2c30a702f897be2ab5bd27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the HMAC verification for the provided authorization value using OPTIGA.<br  />
  <a href="optiga__crypt_8h.html#a5847c76c9c2c30a702f897be2ab5bd27">More...</a><br /></td></tr>
<tr class="separator:a5847c76c9c2c30a702f897be2ab5bd27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3065f34dd412765a53e4d833512fa5"><td class="memItemLeft" align="right" valign="top">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="optiga__crypt_8h.html#aeb3065f34dd412765a53e4d833512fa5">optiga_crypt_clear_auto_state</a> (<a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *me, uint16_t secret)</td></tr>
<tr class="memdesc:aeb3065f34dd412765a53e4d833512fa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This operation clears the AUTO state at OPTIGA for input secret OID.<br  />
  <a href="optiga__crypt_8h.html#aeb3065f34dd412765a53e4d833512fa5">More...</a><br /></td></tr>
<tr class="separator:aeb3065f34dd412765a53e4d833512fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implements the prototype declarations of OPTIGA Crypt module. </p>
<dl class="section author"><dt>Author</dt><dd>Infineon Technologies AG </dd></dl>

<p class="definition">Definition in file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6153e3456437ee829b88d638d301a744"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153e3456437ee829b88d638d301a744">&#9670;&nbsp;</a></span>OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p_instance, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">protection_level&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables the protected I2C communication with OPTIGA for CRYPT instances. </p>
<p>Enables the protected I2C communication with OPTIGA</p><ul>
<li>Sets the protection mode for the supplied instance.<br  />
</li>
<li>Call this function before calling the service layer API which requires protection.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li><a class="el" href="optiga__lib__config__m__v3_8h.html#ac00fecfdecef2033e4db53935b5e076a" title="OPTIGA COMMS shielded connection feature. To disable the feature, undefine the macro.">OPTIGA_COMMS_SHIELDED_CONNECTION</a> macro must be defined.<br  />
</li>
<li><a class="el" href="optiga__crypt_8h.html#a7134573dc358ee6b6ef255b8feb4d9b9" title="Select the protocol version required for the I2C protected communication for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTOCOL_VERSION</a> function must be called once to set the required protocol version<ul>
<li>Currently only the Pre-shared Secret based version is supported.</li>
</ul>
</li>
<li>The host and OPTIGA must be paired and Pre-Shared secret is available.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The protection mode for the instance is reset to <a class="el" href="optiga__lib__common_8h.html#ad11573d4b07fe53b36101b46d03b732d" title="When command data and response data is unprotected.">OPTIGA_COMMS_NO_PROTECTION</a> once the service layer API returns synchronously.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_instance</td><td>Valid pointer to an instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">protection_level</td><td>Required protection mode<ul>
<li><a class="el" href="optiga__lib__common_8h.html#ad11573d4b07fe53b36101b46d03b732d" title="When command data and response data is unprotected.">OPTIGA_COMMS_NO_PROTECTION</a> : Command and response is unprotected</li>
<li><a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a> : Command is protected and response is unprotected</li>
<li><a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a> : Command is unprotected and response is protected</li>
<li><a class="el" href="optiga__lib__common_8h.html#a2a42861da10a3d12802b31ee9dd30707" title="Both command data and response data are protected.">OPTIGA_COMMS_FULL_PROTECTION</a> : Both command and response is protected</li>
<li>To re-establish secure channel, bitwise-OR protection_level with <a class="el" href="optiga__lib__common_8h.html#af99053312743440d258495ad2c3ed5fc" title="Re-establish shielded connection.">OPTIGA_COMMS_RE_ESTABLISH</a> </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l02527">2527</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>

</div>
</div>
<a id="a7134573dc358ee6b6ef255b8feb4d9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7134573dc358ee6b6ef255b8feb4d9b9">&#9670;&nbsp;</a></span>OPTIGA_CRYPT_SET_COMMS_PROTOCOL_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPTIGA_CRYPT_SET_COMMS_PROTOCOL_VERSION</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p_instance, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">version&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select the protocol version required for the I2C protected communication for CRYPT instances. </p>
<p>Select the protocol version required for the I2C protected communication</p><ul>
<li>Select the protocol version for the supplied instance.<br  />
</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li><a class="el" href="optiga__lib__config__m__v3_8h.html#ac00fecfdecef2033e4db53935b5e076a" title="OPTIGA COMMS shielded connection feature. To disable the feature, undefine the macro.">OPTIGA_COMMS_SHIELDED_CONNECTION</a> macro must be defined.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>None</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_instance</td><td>Valid pointer to an instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">version</td><td>Required protocol version<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a9a19aa79758c2fc235d25f8422f2e0ab" title="Pre shared secret protocol version.">OPTIGA_COMMS_PROTOCOL_VERSION_PRE_SHARED_SECRET</a> : Pre-shared Secret based protocol version </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l02555">2555</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="acb7cbc8e36d504f5b29d7a82f41fc9f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb7cbc8e36d504f5b29d7a82f41fc9f7">&#9670;&nbsp;</a></span>optiga_crypt_params_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef union <a class="el" href="unionoptiga__crypt__params.html">optiga_crypt_params</a> <a class="el" href="optiga__crypt_8h.html#acb7cbc8e36d504f5b29d7a82f41fc9f7">optiga_crypt_params_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>union for OPTIGA crypt parameters </p>

</div>
</div>
<a id="aba51e25e66ba8f1a8c9a0d664ce05ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba51e25e66ba8f1a8c9a0d664ce05ddb">&#9670;&nbsp;</a></span>optiga_crypt_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structoptiga__crypt.html">optiga_crypt</a> <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OPTIGA crypt instance structure type. </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l00001">1</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aeb3065f34dd412765a53e4d833512fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3065f34dd412765a53e4d833512fa5">&#9670;&nbsp;</a></span>optiga_crypt_clear_auto_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_clear_auto_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This operation clears the AUTO state at OPTIGA for input secret OID.<br  />
 </p>
<p>Clears the AUTO state and session if it's already acquired.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Acquired session is released after completion of clear auto state operation.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a>.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>OPTIGA OID with input secret. It should be of AUTOREF type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_clear_auto_state.c </p>

</div>
</div>
<a id="aa704c4dce67d7fcd2a2ba9f8a8e68f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa704c4dce67d7fcd2a2ba9f8a8e68f84">&#9670;&nbsp;</a></span>optiga_crypt_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a>* optiga_crypt_create </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>optiga_instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a21dfbe8aba0ab5d12ed647269e64e59f">callback_handler_t</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>caller_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>. </p>
<p>Create an instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>.</p><ul>
<li>Stores the callers context and callback handler.</li>
<li>Allocate memory for <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>None</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>This API is implemented in synchronous mode.</li>
<li>For <b>protected I2C communication</b>,<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__config__m__v3_8h.html#ae50ff77c59d9433957fe47efe3ee51db" title="Default reset protection level for OPTIGA CRYPT and UTIL APIs.">OPTIGA_COMMS_DEFAULT_PROTECTION_LEVEL</a>.</li>
<li>Default protocol version for this API is <a class="el" href="optiga__lib__common_8h.html#a9a19aa79758c2fc235d25f8422f2e0ab" title="Pre shared secret protocol version.">OPTIGA_COMMS_PROTOCOL_VERSION_PRE_SHARED_SECRET</a>.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">optiga_instance_id</td><td>Indicates the OPTIGA instance to be associated with <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>. Should be defined as below: Use <a class="el" href="optiga__lib__common_8h.html#a96c78e78aeb4e2223983e0febbd74429" title="Instance id of OPTIGA slave.">OPTIGA_INSTANCE_ID_0</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>Pointer to callback function, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">caller_context</td><td>Pointer to upper layer context. Contains user context data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a></td><td>On success function will return pointer of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>. </td></tr>
    <tr><td class="paramname">NULL</td><td>Input arguments are NULL.<br  />
 Low layer function fails.<br  />
 OPTIGA_CMD_MAX_REGISTRATIONS number of instances are already created. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab15b091ec91fec61011a44f7c6385d1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab15b091ec91fec61011a44f7c6385d1d">&#9670;&nbsp;</a></span>optiga_crypt_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys an instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>. </p>
<p>Destroys the <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> instance.</p><ul>
<li>De-allocate the memory of the <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> instance.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>An instance of <a class="el" href="structoptiga__crypt.html" title="OPTIGA crypt instance structure.">optiga_crypt</a> using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a> must be available.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>User must take care to nullify the instance pointer.</li>
<li>Invoke this API only after all the asynchronous process is completed otherwise the behavior of software stack is not defined.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a8e9c9419d8fae44064093fa516bc6da1" title="OPTIGA host library API execution is successful.">OPTIGA_LIB_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a960387f95d10c5987e18b8eb67ca6197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a960387f95d10c5987e18b8eb67ca6197">&#9670;&nbsp;</a></span>optiga_crypt_ecc_generate_keypair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_ecc_generate_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a270ba3f6c8c22bbe572713bbf85deb1d">optiga_ecc_curve_t</a>&#160;</td>
          <td class="paramname"><em>curve_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>public_key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a key pair based on ECC curves. </p>
<p>Generates an ECC key-pair based on the input curve.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a79e979f80bd157039737a31c0119e178" title="Generates ECC or RSA key-pair.">optiga_cmd_gen_keypair</a> API, based on the input arguments.<br  />
</li>
<li>Generate an ECC key pair using OPTIGA.</li>
<li>Private key is exported only if explicitly requested otherwise it is stored in the input private key OID.</li>
<li>Public key is always exported.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">curve_id</td><td>ECC curve id as <a class="el" href="optiga__lib__common_8h.html#a5080b446603b7738d6449d9442b1f5d8" title="Specifies the key curve type in OPTIGA.">optiga_ecc_curve</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_usage</td><td>Key usage defined in <a class="el" href="optiga__lib__common_8h.html#ac9efc8220aa21e6d8324008f6db108d4" title="Specifies the key usage type in OPTIGA.">optiga_key_usage_t</a>.<ul>
<li>Values from <a class="el" href="optiga__lib__common_8h.html#ad388c2786c76065d1d9ce9cffc25670e" title="Specifies the key usage type in OPTIGA.">optiga_key_usage</a> can be logically ORed and passed.<br  />
</li>
<li>It is ignored if export_private_key is TRUE (1). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_private_key</td><td>TRUE (1) or Non-Zero value - Exports private key to the host.<br  />
 FALSE (0) - Exports only public key to the host and writes private key to OPTIGA. The input key_usage is ignored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>Buffer to store private key or private key OID of OPTIGA, must not be NULL.<ul>
<li>If export_private_key is TRUE, assign pointer to a buffer to store private key.</li>
<li>The size of the buffer must be sufficient enough to accommodate the key type and additional DER encoding formats.</li>
<li>If export_private_key is FALSE, assign pointer to variable of type <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">public_key</td><td>Buffer to store public key, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key_length</td><td>Initially set as length of buffer to store public_key, later updated as actual length of public_key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_ecc_generate_keypair.c </p>

</div>
</div>
<a id="a6b0ea46c7efe418f1bd88039c9fe07b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b0ea46c7efe418f1bd88039c9fe07b4">&#9670;&nbsp;</a></span>optiga_crypt_ecdh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_ecdh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5">public_key_from_host_t</a> *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>shared_secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the shared secret using ECDH algorithm.<br  />
 </p>
<p>Calculates the shared secret using ECDH algorithm</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#adafd4ef4d53f7a8b33da828bc891b737" title="Calculates shared secret.">optiga_cmd_calc_ssec</a> API, based on the input arguments.<br  />
</li>
<li>Calculates the shared secret based on input private key object ID and public key.</li>
<li>Based on user request (export_to_host), the shared secret can either be exported to the host or be stored in the acquired session object ID.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.</li>
<li>There must be a private key available in the "session context / data object OID" provided as input parameter.</li>
<li>If the private_key type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a960387f95d10c5987e18b8eb67ca6197" title="Generates a key pair based on ECC curves.">optiga_crypt_ecc_generate_keypair</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
<li>The buffer size for shared secret should be appropriately provided by the user</li>
<li>If the user provides <b>private_key</b> as session based and <b>export_to_host</b> as FALSE,<br  />
 then the shared secret generated will overwrite the private key stored in the session object ID</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>Object ID of the private key stored in OPTIGA.<br  />
<ul>
<li>Possible values are from the <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a> <br  />
</li>
<li>Argument check for private_key is not done since OPTIGA will provide an error for invalid private_key. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key</td><td>Pointer to the public key structure for shared secret generation with its properties, must not be NULL.<br  />
<ul>
<li>Provide the inputs according to the structure type <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5" title="Specifies the data structure of the Public Key details (key, size and type)">public_key_from_host_t</a> </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the generated shared secret to Host. <br  />
 FALSE (0) - Stores the generated shared secret into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">shared_secret</td><td>Pointer to the shared secret buffer, only if <b>export_to_host</b> is TRUE. The size of the buffer shall be equal or more than the key size.<br  />
 Otherwise provide NULL as input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the private_key type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_ecdh.c </p>

</div>
</div>
<a id="a9f04d48ff9e3a9fab8c887878464ec94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f04d48ff9e3a9fab8c887878464ec94">&#9670;&nbsp;</a></span>optiga_crypt_ecdsa_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_ecdsa_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>digest_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>signature_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a signature for the given digest. </p>
<p>Generates a signature for the given digest using private key stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#ab4461677b0c47dee5c46765df7439b97" title="Calculate signature on digest.">optiga_cmd_calc_sign</a> API, based on the input arguments.<br  />
</li>
<li>Generates signature for the input digest.</li>
<li>Exports the generated signature.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.<br  />
</li>
<li>If the private_key type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a960387f95d10c5987e18b8eb67ca6197" title="Generates a key pair based on ECC curves.">optiga_crypt_ecc_generate_keypair</a> ) </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>Digest on which signature is generated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_length</td><td>Length of the input digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>Private key OID to generate signature. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">signature</td><td>Pointer to store generated signature, must not be NULL.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the additional DER encoding formatting for R and S components of signature. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">signature_length</td><td>Length of signature. Initial value set as length of buffer, later updated as the actual length of generated signature.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the private_key type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_ecdsa_sign.c </p>

</div>
</div>
<a id="ac336a4e5caf1cd962f101a27ee88dd19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac336a4e5caf1cd962f101a27ee88dd19">&#9670;&nbsp;</a></span>optiga_crypt_ecdsa_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_ecdsa_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>digest_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>signature_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key_source_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the signature over the given digest. </p>
<p>Verifies the signature over a given digest provided with the input data.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a7214a34d9a267b5322440436f9c4a7ca" title="Verifies the signature over the given digest.">optiga_cmd_verify_sign</a> API, based on the input arguments.<br  />
</li>
<li>Verifies the signature over the given provided with the input data using public key.</li>
<li>It invokes the callback handler of the instance, when it is asynchronously completed.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>Pointer to a given digest buffer, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_length</td><td>Length of digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Pointer to a given signature buffer, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_length</td><td>Length of signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key_source_type</td><td>Public key from host / public key of certificate OID from OPTIGA. Value must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the public key is to used from the certificate data object from OPTIGA.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value , if the public key is provided by host. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key</td><td>Public key from host / OID of certificate object. Value must be one of the below<ul>
<li>For certificate OID, pointer OID value must be passed.</li>
<li>For Public key from host, pointer to <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5" title="Specifies the data structure of the Public Key details (key, size and type)">public_key_from_host_t</a> instance.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_ecdsa_verify.c </p>

</div>
</div>
<a id="a1e6ec5dae6a50a2c8eb5c270d4071add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6ec5dae6a50a2c8eb5c270d4071add">&#9670;&nbsp;</a></span>optiga_crypt_generate_auth_code()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_generate_auth_code </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a39ff1bc194d378852ec0d70e3f411d17">optiga_rng_type_t</a>&#160;</td>
          <td class="paramname"><em>rng_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>optional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>optional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>random_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>random_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a random number using OPTIGA and stores the same in acquired session context at OPTIGA. </p>
<p>Generates random stream code for user provided length.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#aa1e031bd224b53d5a25e9229fb275f6f" title="Generates random data or pre-master secret for RSA key exchange.">optiga_cmd_get_random</a> API, based on the input arguments to retrieve random data <br  />
</li>
<li>Generated random is returned to host .</li>
<li>Generated random and optional data is also stored in the session context acquired at OPTIGA.</li>
<li>Data stored in the acquired session context acquired at OPTIGA is used as an auth code.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
<li>Minimum length of generated random data is 8 bytes.</li>
<li>Auth Code is a concatenation of optional data and random data.</li>
<li>Maximum length of auth code is 48 bytes.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rng_type</td><td>Type of random data generator.<ul>
<li>The input must be from <a class="el" href="optiga__lib__common_8h.html#a33fcf544087433f9abbcab2ba3085f34" title="Specifies the random generation types.">optiga_rng_type</a>.</li>
<li>Argument check for rng_type is not done since OPTIGA will provide an error for invalid rng_type. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optional_data</td><td>Optional data that gets prepended to the generated random secret.<ul>
<li>Can be set to NULL, if not required </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optional_data_length</td><td>Length of the optional data provided. It is ignored if optional_data is NULL<ul>
<li>Value can be up to 58 bytes</li>
<li>Difference in random data length and optional data length is less than 8 bytes </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">random_data</td><td>Pointer to the buffer into which random data is stored, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">random_data_length</td><td>Length of random data to be generated.<ul>
<li>Minimum range is 8 bytes.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7f0b45b49d78f06983764d2e1e75d11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0b45b49d78f06983764d2e1e75d11f">&#9670;&nbsp;</a></span>optiga_crypt_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#abaf8b33ec5d8cad61205a8592f93700a">optiga_hash_type_t</a>&#160;</td>
          <td class="paramname"><em>hash_algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>source_of_data_to_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data_to_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates a hashing for input data and returns digest. </p>
<p>Updates hashing for the given data and returns digest.<br  />
</p>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.</li>
<li>Error codes from lower layer will be returned as it is.<br  />
</li>
</ul>
</dd></dl>
<p><br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_algorithm</td><td>Hash algorithm of <a class="el" href="optiga__lib__common_8h.html#abaf8b33ec5d8cad61205a8592f93700a" title="Specifies the hashing algorithm type in OPTIGA.">optiga_hash_type_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">source_of_data_to_hash</td><td>Data from host / Data in OPTIGA. Must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value ,if source of data is from Host.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the source of data is from OPTIGA. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_to_hash</td><td>Data for hashing either in <a class="el" href="optiga__lib__common_8h.html#ad8a62680a4cec0ec74da2e405859a375" title="Specifies the structure to provide the details of data to be hashed from host.">hash_data_from_host_t</a> or in <a class="el" href="optiga__lib__common_8h.html#a4197bb122268060d0e31334ad9695ddf" title="Specifies the structure to provide the details of data to be hashed from OPTIGA.">hash_data_in_optiga_t</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_output</td><td>Pointer to the valid buffer to store hash output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hash.c </p>

</div>
</div>
<a id="af437164f915a17a8a39958c8e8ece092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af437164f915a17a8a39958c8e8ece092">&#9670;&nbsp;</a></span>optiga_crypt_hash_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hash_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *&#160;</td>
          <td class="paramname"><em>hash_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizes and exports the hash output. </p>
<p>Finalizes the hash context and returns hash as output.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a2b117242da9bd77703724805a430d58d" title="Generates hash on external data or data in OID.">optiga_cmd_calc_hash</a> API, based on the input arguments.<br  />
</li>
<li>Finalize the hash from the input hash context</li>
<li>Exports the finalized hash.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> from <a class="el" href="optiga__crypt_8h.html#af4c436818097a4a2a391a0e71fdf4847" title="Initializes a hash context.">optiga_crypt_hash_start</a> or <a class="el" href="optiga__crypt_8h.html#a98132f20df82af9d36c3c0e7f4d83242" title="Updates a hash context with the input data.">optiga_crypt_hash_update</a> must be available.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layer will be returned as it is.</li>
<li>hash context is not updated by this API. This can be used later to fulfill intermediate hash use-cases.</li>
<li>User must save the output hash context for further usage as OPTIGA does not store it internally.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_ctx</td><td>Pointer to <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> containing hash context from OPTIGA, must not be NULL.<ul>
<li>The minimum size of the <b>context_buffer</b> must be 209 bytes in <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> for hash algo <a class="el" href="optiga__lib__common_8h.html#af3db05d261df5a9b21d1fcfe46f3d520a3430db76b3890514bbd2d4246e88fce6" title="Hash algorithm type SHA256.">OPTIGA_HASH_TYPE_SHA_256</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_output</td><td>Output Hash.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hash.c </p>

</div>
</div>
<a id="af4c436818097a4a2a391a0e71fdf4847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c436818097a4a2a391a0e71fdf4847">&#9670;&nbsp;</a></span>optiga_crypt_hash_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hash_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *&#160;</td>
          <td class="paramname"><em>hash_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a hash context. </p>
<p>Sets up a hash context and exports it.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a2b117242da9bd77703724805a430d58d" title="Generates hash on external data or data in OID.">optiga_cmd_calc_hash</a> API, based on the input arguments.<br  />
</li>
<li>Initializes a new hash context.<br  />
</li>
<li>Exports the hash context to caller.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.<br  />
</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.</li>
<li>Error codes from lower layer will be returned as it is.<br  />
</li>
<li>User must save the output hash context for further usage because OPTIGA does not store it internally.<br  />
</li>
</ul>
</dd></dl>
<p><br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_ctx</td><td>Pointer to <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> to store the hash context from OPTIGA.<ul>
<li>The minimum size of the <b>context_buffer</b> must be 209 bytes in <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> for hash algo <a class="el" href="optiga__lib__common_8h.html#af3db05d261df5a9b21d1fcfe46f3d520a3430db76b3890514bbd2d4246e88fce6" title="Hash algorithm type SHA256.">OPTIGA_HASH_TYPE_SHA_256</a>.</li>
<li>The input <b>hash_algo</b> in <b>hash_ctx</b> must be from <a class="el" href="optiga__lib__common_8h.html#af3db05d261df5a9b21d1fcfe46f3d520" title="Specifies the hashing algorithm type in OPTIGA.">optiga_hash_type</a>.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hash.c </p>

</div>
</div>
<a id="a98132f20df82af9d36c3c0e7f4d83242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98132f20df82af9d36c3c0e7f4d83242">&#9670;&nbsp;</a></span>optiga_crypt_hash_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hash_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb">optiga_hash_context_t</a> *&#160;</td>
          <td class="paramname"><em>hash_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>source_of_data_to_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data_to_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates a hash context with the input data. </p>
<p>Updates hashing for the given data and hash context then export the updated hash context.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a2b117242da9bd77703724805a430d58d" title="Generates hash on external data or data in OID.">optiga_cmd_calc_hash</a> API, based on the input arguments.<br  />
</li>
<li>Update the input hash context.<br  />
</li>
<li>Exports the hash context to caller.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.<br  />
</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> from <a class="el" href="optiga__crypt_8h.html#af4c436818097a4a2a391a0e71fdf4847" title="Initializes a hash context.">optiga_crypt_hash_start</a> or <a class="el" href="optiga__crypt_8h.html#a98132f20df82af9d36c3c0e7f4d83242" title="Updates a hash context with the input data.">optiga_crypt_hash_update</a> must be available.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><br  />
<ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layer will be returned as it is.<br  />
</li>
<li>User must save the output hash context for further usage as OPTIGA does not store it internally.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_ctx</td><td>Pointer to <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> containing hash context from OPTIGA, must not be NULL<ul>
<li>The minimum size of the <b>context_buffer</b> must be 209 bytes in <a class="el" href="optiga__lib__common_8h.html#a4054745719696d5db7d80cefdfebc8fb" title="Specifies the structure to the Hash context details managed by OPTIGA.">optiga_hash_context_t</a> for hash algo <a class="el" href="optiga__lib__common_8h.html#af3db05d261df5a9b21d1fcfe46f3d520a3430db76b3890514bbd2d4246e88fce6" title="Hash algorithm type SHA256.">OPTIGA_HASH_TYPE_SHA_256</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">source_of_data_to_hash</td><td>Data from host / Data in optiga. Must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value ,if source of data is from Host.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the source of data is from OPITGA. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_to_hash</td><td>Data for hashing either in <a class="el" href="structhash__data__from__host.html" title="Specifies the structure to provide the details of data to be hashed from host.">hash_data_from_host</a> or in <a class="el" href="structhash__data__in__optiga.html" title="Specifies the structure to provide the details of data to be hashed from OPTIGA.">hash_data_in_optiga</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hash.c </p>

</div>
</div>
<a id="a1e09748f1a0601251739b883be03596c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e09748f1a0601251739b883be03596c">&#9670;&nbsp;</a></span>optiga_crypt_hkdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hkdf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a86002cbbdbacbc858fddbe262c03e66f">optiga_hkdf_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>info_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA.<br  />
 </p>
<p>Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>The derived key is either stored in a OPTIGA session context or exported back to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
<li>If the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>HKDF scheme as <a class="el" href="optiga__lib__common_8h.html#a86002cbbdbacbc858fddbe262c03e66f" title="Specifies the HKDF key derivation types in OPTIGA.">optiga_hkdf_type_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID of the secret stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>Pointer to buffer containing salt value, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Length of salt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Pointer to buffer containing application specific information, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info_length</td><td>Length of info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hkdf.c </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_a1e09748f1a0601251739b883be03596c_icgraph.png" border="0" usemap="#aoptiga__crypt_8h_a1e09748f1a0601251739b883be03596c_icgraph" alt=""/></div>
<map name="optiga__crypt_8h_a1e09748f1a0601251739b883be03596c_icgraph" id="optiga__crypt_8h_a1e09748f1a0601251739b883be03596c_icgraph">
<area shape="rect" title="Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA." alt="" coords="227,56,351,83"/>
<area shape="rect" href="optiga__crypt_8h.html#a66d46466b1afc2d6019a5667a88f9fcd" title="Derives a key or shared secret using HKDF&#45;SHA256 operation from the secret stored in OPTIGA." alt="" coords="5,5,179,32"/>
<area shape="rect" href="optiga__crypt_8h.html#a9b7f6787b5a9e8d15992b0058eec7901" title="Derives a key or shared secret using HKDF&#45;SHA384 operation from the secret stored in OPTIGA." alt="" coords="5,56,179,83"/>
<area shape="rect" href="optiga__crypt_8h.html#addaa20d04f272886e8090ca34cbdf406" title="Derives a key or shared secret using HKDF&#45;SHA512 operation from the secret stored in OPTIGA." alt="" coords="5,107,179,133"/>
</map>
</div>

</div>
</div>
<a id="a66d46466b1afc2d6019a5667a88f9fcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66d46466b1afc2d6019a5667a88f9fcd">&#9670;&nbsp;</a></span>optiga_crypt_hkdf_sha256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hkdf_sha256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>info_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key or shared secret using HKDF-SHA256 operation from the secret stored in OPTIGA.<br  />
 </p>
<p>Derives a key or shared secret using HKDF-SHA256 operation from the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>The derived key is either stored in a OPTIGA session context or exported back to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
<li>If the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID of the secret stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>Pointer to buffer containing salt value, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Length of salt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Pointer to buffer containing application specific information, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info_length</td><td>Length of info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hkdf.c </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l02145">2145</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_a66d46466b1afc2d6019a5667a88f9fcd_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_a66d46466b1afc2d6019a5667a88f9fcd_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_a66d46466b1afc2d6019a5667a88f9fcd_cgraph" id="optiga__crypt_8h_a66d46466b1afc2d6019a5667a88f9fcd_cgraph">
<area shape="rect" title="Derives a key or shared secret using HKDF&#45;SHA256 operation from the secret stored in OPTIGA." alt="" coords="5,5,179,32"/>
<area shape="rect" href="optiga__crypt_8h.html#a1e09748f1a0601251739b883be03596c" title="Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA." alt="" coords="227,5,351,32"/>
</map>
</div>

</div>
</div>
<a id="a9b7f6787b5a9e8d15992b0058eec7901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7f6787b5a9e8d15992b0058eec7901">&#9670;&nbsp;</a></span>optiga_crypt_hkdf_sha384()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hkdf_sha384 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>info_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key or shared secret using HKDF-SHA384 operation from the secret stored in OPTIGA.<br  />
 </p>
<p>Derives a key or shared secret using HKDF-SHA384 operation from the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>The derived key is either stored in a OPTIGA session context or exported back to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
<li>If the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID of the secret stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>Pointer to buffer containing salt value, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Length of salt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Pointer to buffer containing application specific information, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info_length</td><td>Length of info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 None </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l02216">2216</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_a9b7f6787b5a9e8d15992b0058eec7901_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_a9b7f6787b5a9e8d15992b0058eec7901_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_a9b7f6787b5a9e8d15992b0058eec7901_cgraph" id="optiga__crypt_8h_a9b7f6787b5a9e8d15992b0058eec7901_cgraph">
<area shape="rect" title="Derives a key or shared secret using HKDF&#45;SHA384 operation from the secret stored in OPTIGA." alt="" coords="5,5,179,32"/>
<area shape="rect" href="optiga__crypt_8h.html#a1e09748f1a0601251739b883be03596c" title="Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA." alt="" coords="227,5,351,32"/>
</map>
</div>

</div>
</div>
<a id="addaa20d04f272886e8090ca34cbdf406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addaa20d04f272886e8090ca34cbdf406">&#9670;&nbsp;</a></span>optiga_crypt_hkdf_sha512()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hkdf_sha512 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>info_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key or shared secret using HKDF-SHA512 operation from the secret stored in OPTIGA.<br  />
 </p>
<p>Derives a key or shared secret using HKDF-SHA384 operation from the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>The derived key is either stored in a OPTIGA session context or exported back to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
<li>If the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID of the secret stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>Pointer to buffer containing salt value, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Length of salt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Pointer to buffer containing application specific information, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info_length</td><td>Length of info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
 Session is not available in instance and the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 None </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l02287">2287</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_addaa20d04f272886e8090ca34cbdf406_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_addaa20d04f272886e8090ca34cbdf406_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_addaa20d04f272886e8090ca34cbdf406_cgraph" id="optiga__crypt_8h_addaa20d04f272886e8090ca34cbdf406_cgraph">
<area shape="rect" title="Derives a key or shared secret using HKDF&#45;SHA512 operation from the secret stored in OPTIGA." alt="" coords="5,5,179,32"/>
<area shape="rect" href="optiga__crypt_8h.html#a1e09748f1a0601251739b883be03596c" title="Derives a key or shared secret using HKDF operation from the secret stored in OPTIGA." alt="" coords="227,5,351,32"/>
</map>
</div>

</div>
</div>
<a id="a56d236cbe1ebc6a28e333e011a98e661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d236cbe1ebc6a28e333e011a98e661">&#9670;&nbsp;</a></span>optiga_crypt_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates HMAC on the input message using input secret from OPTIGA and exports the generated HMAC to the host.<br  />
 </p>
<p>Generates HMAC on the input message using input secret from OPTIGA and exports the generated HMAC to host.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Generates HMAC on the input data and exports it to host.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a>.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>HMAC type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>OPTIGA OID with input secret<ul>
<li>Input secret must be available at the specified OID.<br  />
</li>
<li>To indicate session OID (already acquired by instance), specify <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>Pointer to input data for HMAC generation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data_length</td><td>Length of input data for HMAC generation.<ul>
<li>Must be greater than 0.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mac</td><td>Pointer to buffer to store generated HMAC </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mac_length</td><td>Pointer to length of the <b>mac</b>. Initial value set as length of buffer, later updated as the actual length of generated HMAC.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the HMAC.</li>
<li>If the <b>mac_length</b> is lesser than the length of MAC received from OPTIGA, then first <b>mac_length</b> bytes are only returned.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hmac.c </p>

</div>
</div>
<a id="a9c13f6a51f7a0707b9612b7ed55bb359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c13f6a51f7a0707b9612b7ed55bb359">&#9670;&nbsp;</a></span>optiga_crypt_hmac_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hmac_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates HMAC on the input message using input secret from OPTIGA and exports the finalized HMAC to host.<br  />
 </p>
<p>Generates HMAC on the input message using input secret from OPTIGA and exports the finalized HMAC to host.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Generates HMAC on the input data and exports it to host.</li>
<li>Input secret specified in <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> is used to generate HMAC.<br  />
</li>
<li>It terminates the strict sequence.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The HMAC sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a>, before calling this API.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> is used in this API.<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>Pointer to input data for HMAC generation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data_length</td><td>Length of input data for HMAC generation.<ul>
<li>Must be greater than 0.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mac</td><td>Pointer to buffer to store generated HMAC </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mac_length</td><td>Pointer to length of the <b>mac</b>. Initial value set as length of buffer, later updated as the actual length of generated HMAC.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the HMAC.</li>
<li>If the <b>mac_length</b> is lesser than the length of MAC received from OPTIGA, then first <b>mac_length</b> bytes are only returned.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hmac.c </p>

</div>
</div>
<a id="a321997c63b9d4ace67d9e974b08cd229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a321997c63b9d4ace67d9e974b08cd229">&#9670;&nbsp;</a></span>optiga_crypt_hmac_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hmac_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.<br  />
 </p>
<p>Initiates a HMAC generation sequence for the input data.<br  />
</p><ul>
<li>It marks the beginning of a strict sequence. None of the service layer API will be processed until the strict sequence is terminated.</li>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Generates HMAC on the input data but does not export it to host.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a>.<br  />
</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated<ul>
<li>In case of an error from lower layer.<br  />
</li>
<li>Same instance is used for other service layer APIs (except <a class="el" href="optiga__crypt_8h.html#a995035c7ab4b47aacc9bc7216961bb3e" title="Generates HMAC on the input message using input secret from OPTIGA, update the previously generated H...">optiga_crypt_hmac_update</a> and <a class="el" href="optiga__crypt_8h.html#a9c13f6a51f7a0707b9612b7ed55bb359" title="Generates HMAC on the input message using input secret from OPTIGA and exports the finalized HMAC to ...">optiga_crypt_hmac_finalize</a>).<br  />
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>HMAC type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>OPTIGA OID with input secret<ul>
<li>Input secret must be available at the specified OID.<br  />
</li>
<li>To indicate session OID (already acquired by instance), specify <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>Pointer to input data for HMAC generation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data_length</td><td>Length of input data for HMAC generation.<ul>
<li>Must be greater than 0.<br  />
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hmac.c </p>

</div>
</div>
<a id="a995035c7ab4b47aacc9bc7216961bb3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995035c7ab4b47aacc9bc7216961bb3e">&#9670;&nbsp;</a></span>optiga_crypt_hmac_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hmac_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates HMAC on the input message using input secret from OPTIGA, update the previously generated HMAC value internally.<br  />
 </p>
<p>Generates HMAC on the input message using input secret from OPTIGA and updates the previously generated HMAC value internally.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Generates HMAC on the input data but does not export it to host.</li>
<li>Input secret specified in <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> is used to generate HMAC.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The HMAC sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a>, before calling this API.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> is used in this API.<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#a321997c63b9d4ace67d9e974b08cd229" title="Initiates a HMAC generation sequence for the input data using input secret from OPTIGA.">optiga_crypt_hmac_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>Pointer to input data for HMAC generation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data_length</td><td>Length of input data for HMAC generation.<ul>
<li>Must be greater than 0.<br  />
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hmac.c </p>

</div>
</div>
<a id="a5847c76c9c2c30a702f897be2ab5bd27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5847c76c9c2c30a702f897be2ab5bd27">&#9670;&nbsp;</a></span>optiga_crypt_hmac_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_hmac_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c">optiga_hmac_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hmac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>hmac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the HMAC verification for the provided authorization value using OPTIGA.<br  />
 </p>
<p>Verifies HMAC generated at host with HMAC generated from OPTIGA for the provided authorization value.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Acquired session gets released after completion of hmac verify operation between host and OPTIGA.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The data object specified by input <b>secret</b> must have a secret written into it.<br  />
</li>
<li>Session has already been acquired by <a class="el" href="optiga__crypt_8h.html#a1e6ec5dae6a50a2c8eb5c270d4071add" title="Generates a random number using OPTIGA and stores the same in acquired session context at OPTIGA.">optiga_crypt_generate_auth_code</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a>.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>HMAC type as <a class="el" href="optiga__lib__common_8h.html#a8c73c66c94fd337ea89423163eaca00c" title="Specifies the HMAC generation types in OPTIGA.">optiga_hmac_type_t</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>OPTIGA OID with input secret<ul>
<li>Input secret must be available at the specified OID.<br  />
</li>
<li>Data object type must be AUTOREF. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data</td><td>Pointer to input data for HMAC generation.<ul>
<li>Input data is concatenation of optional data, random and arbitrary data.</li>
<li>Optional data is input provided to <a class="el" href="optiga__crypt_8h.html#a1e6ec5dae6a50a2c8eb5c270d4071add" title="Generates a random number using OPTIGA and stores the same in acquired session context at OPTIGA.">optiga_crypt_generate_auth_code</a> and random data is returned by <a class="el" href="optiga__crypt_8h.html#a1e6ec5dae6a50a2c8eb5c270d4071add" title="Generates a random number using OPTIGA and stores the same in acquired session context at OPTIGA.">optiga_crypt_generate_auth_code</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_data_length</td><td>Length of input data.<ul>
<li>Must be greater than 0.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac</td><td>Pointer to buffer of HMAC generated at host which gets verified at OPTIGA. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_length</td><td>Length of the generated <b>hmac</b> at host.<ul>
<li>Host generated hmac length must be the size of output defined in respective hash algorithm used in hmac scheme.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_hmac_verify.c </p>

</div>
</div>
<a id="a008ddc10a1cffed620f2b8e71b21fc55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a008ddc10a1cffed620f2b8e71b21fc55">&#9670;&nbsp;</a></span>optiga_crypt_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a39ff1bc194d378852ec0d70e3f411d17">optiga_rng_type_t</a>&#160;</td>
          <td class="paramname"><em>rng_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>random_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>random_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a random number. </p>
<p>Generates the requested random stream of data for the user provided length.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#aa1e031bd224b53d5a25e9229fb275f6f" title="Generates random data or pre-master secret for RSA key exchange.">optiga_cmd_get_random</a> API, based on the input arguments to retrieve random data .</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.<br  />
</li>
<li>The maximum value of the <b>random_data_length</b> parameter is size of buffer <b>random_data</b>. In case the value is greater than buffer size, memory corruption can occur.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rng_type</td><td>Type of random data generator.<ul>
<li>The input must be from <a class="el" href="optiga__lib__common_8h.html#a33fcf544087433f9abbcab2ba3085f34" title="Specifies the random generation types.">optiga_rng_type</a>.</li>
<li>Argument check for rng_type is not done since OPTIGA will provide an error for invalid rng_type. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">random_data</td><td>Pointer to the buffer into which random data is stored, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">random_data_length</td><td>Length of random data to be generated.<ul>
<li>Range should be 8 - 256 bytes.</li>
<li>Length validation is not done, since OPTIGA will provide an error for invalid random_data_length.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_random.c </p>

</div>
</div>
<a id="a392dbf9efe92a6f3f03a1696e15fd382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392dbf9efe92a6f3f03a1696e15fd382">&#9670;&nbsp;</a></span>optiga_crypt_rsa_decrypt_and_export()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_decrypt_and_export </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a>&#160;</td>
          <td class="paramname"><em>encryption_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>encrypted_message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>message_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts input data using OPTIGA private key and export it to the host.<br  />
 </p>
<p>Decrypts input data using RSA private key from OPTIGA and exports the decrypted data to the host.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a3a6ff5135f291764774c7a61d390467d" title="Decrypts data using OPTIGA RSA private key.">optiga_cmd_decrypt_asym</a> API, based on the input arguments.<br  />
</li>
<li>Decrypts the input data using a RSA private key.</li>
<li>The RSA private key from OPTIGA is referred by <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>.</li>
<li>Decrypted data is exported back to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is OPTIGA_COMMS_RESPONSE_PROTECTION.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li><b>*message_length</b> Initially , it contains the size of buffer provided by user to store the decrypted data. On successful decryption, this value is updated with actual length of the decrypted data.<br  />
 In case of any error, the value is set to 0.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_scheme</td><td>RSA encryption scheme. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_message</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_message_length</td><td>Length of the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to a label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>RSA private key in OPTIGA </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">message</td><td>Pointer to buffer to store decrypted message. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">message_length</td><td>Pointer to length of the decrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_decrypt.c </p>

</div>
</div>
<a id="ab304f6b4eed50a2455069f2f27824a92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab304f6b4eed50a2455069f2f27824a92">&#9670;&nbsp;</a></span>optiga_crypt_rsa_decrypt_and_store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_decrypt_and_store </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a>&#160;</td>
          <td class="paramname"><em>encryption_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>encrypted_message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts input data using OPTIGA private key and stores it in a OPTIGA session.<br  />
 </p>
<p>Decrypts input data using RSA private key from OPTIGA and stores it in a OPTIGA session.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a3a6ff5135f291764774c7a61d390467d" title="Decrypts data using OPTIGA RSA private key.">optiga_cmd_decrypt_asym</a> API, based on the input arguments.<br  />
</li>
<li>Decrypts the input data using a RSA private key.</li>
<li>The RSA private key from OPTIGA is referred by <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>.</li>
<li>Stores the decrypted data in the acquired OPTIGA session.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_RESPONSE_PROTECTION.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_scheme</td><td>RSA encryption scheme. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_message</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_message_length</td><td>Length of the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to a label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>RSA private key in OPTIGA.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_decrypt.c </p>

</div>
</div>
<a id="ae1757863bc1dd0191d41a10a360d728f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1757863bc1dd0191d41a10a360d728f">&#9670;&nbsp;</a></span>optiga_crypt_rsa_encrypt_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_encrypt_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a>&#160;</td>
          <td class="paramname"><em>encryption_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key_source_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>encrypted_message_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts message using RSA public key.<br  />
 </p>
<p>Encrypts message using RSA public key which is either provided by the host or stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a4c775469c60fca949e84bbbd2b08be4b" title="Encrypt data using RSA public key.">optiga_cmd_encrypt_asym</a> API, based on the input arguments.<br  />
</li>
<li>Encrypts the input message using a RSA public key.</li>
<li>The RSA public key either provided by the host or refers to a OID in OPTIGA containing the public key certificate.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li><b>encrypted_message_length</b> Initially, it contains the size of buffer provided by user to store the encrypted data. On successful encryption, this value is updated with actual length of the encrypted data.<br  />
 In case of any error, the value is set to 0.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_scheme</td><td>RSA encryption scheme. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Pointer to message to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to a label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label (Reserved for future use). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key_source_type</td><td>Public key from host / public key of certificate OID from OPTIGA. Value must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the public key is to be used from the certificate data object from OPTIGA.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value , if the public key is provided by host. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key</td><td>Public key from host / public key of certificate OID. Value must be one of the below<ul>
<li>For certificate OID, pointer to OID value must be passed.</li>
<li>For Public key from host, pointer to <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5" title="Specifies the data structure of the Public Key details (key, size and type)">public_key_from_host_t</a> instance. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_message</td><td>Pointer to buffer to store encrypted message. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_message_length</td><td>Pointer to length of the encrypted message.<ul>
<li>Out length is depends on the key size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_encrypt_message.c </p>

</div>
</div>
<a id="a3e8bfac9583be02daf34a9b7d8004ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8bfac9583be02daf34a9b7d8004ff3">&#9670;&nbsp;</a></span>optiga_crypt_rsa_encrypt_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_encrypt_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ae6be2e9d94acc66ed73b331bd877226d">optiga_rsa_encryption_scheme_t</a>&#160;</td>
          <td class="paramname"><em>encryption_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key_source_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>encrypted_message_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts session data using RSA public key.<br  />
 </p>
<p>Encrypts session data using RSA public key which is either provided by the host or stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a4c775469c60fca949e84bbbd2b08be4b" title="Encrypt data using RSA public key.">optiga_cmd_encrypt_asym</a> API, based on the input arguments.<br  />
</li>
<li>Encrypts the data in the session OID using a RSA public key.</li>
<li>The RSA public key either provided by the host or refers to a OID in OPTIGA containing the public key certificate.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>A session OID must be acquired using <a class="el" href="optiga__crypt_8h.html#a49aa659f73e4a77814a2ded710ddb896" title="Generates a pre-master secret.">optiga_crypt_rsa_generate_pre_master_secret</a> otherwise <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> is returned.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li><b>encrypted_message_length</b> contains the size of buffer provided by user to store the encrypted data. On successful encryption, this value is updated with actual length of the encrypted data.<br  />
 In case of any error, the value is set to 0.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_scheme</td><td>RSA encryption scheme. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to a label (used only is case of RSAES_OAEP_SHA256 otherwise ignored). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label (used only is case of RSAES_OAEP_SHA256 otherwise ignored). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key_source_type</td><td>Public key from host / public key of certificate OID from OPTIGA. Value must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the public key is to be used from the certificate data object from OPTIGA.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value, if the public key is provided by host. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key</td><td>Public key from host / public key of certificate OID. Value must be one of the below<ul>
<li>For certificate OID, pointer to OID value must be passed.</li>
<li>For Public key from host, pointer to <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5" title="Specifies the data structure of the Public Key details (key, size and type)">public_key_from_host_t</a> instance. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_message</td><td>Pointer to buffer to store encrypted message. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_message_length</td><td>Pointer to length of the encrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_encrypt_session.c </p>

</div>
</div>
<a id="a5b645d8c9df6c84e40c27170cc9a8de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b645d8c9df6c84e40c27170cc9a8de7">&#9670;&nbsp;</a></span>optiga_crypt_rsa_generate_keypair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_generate_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a05eae1b76c2aea0a97b883b26e9eb220">optiga_rsa_key_type_t</a>&#160;</td>
          <td class="paramname"><em>key_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>public_key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a key pair based on RSA key type. </p>
<p>Generates a RSA key-pair based on the type of the key.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a79e979f80bd157039737a31c0119e178" title="Generates ECC or RSA key-pair.">optiga_cmd_gen_keypair</a> API, based on the input arguments.<br  />
</li>
<li>Generate an RSA key pair using OPTIGA.</li>
<li>If export is requested, exports the private key else stores it in the input private key OID.</li>
<li>Always exports the public keys.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened before using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
<li>RSA key pair generation on OPTIGA can go beyond 50 seconds therefore use a larger value for optiga comms TL_MAX_EXIT_TIMEOUT. The default value is hence set to 180 seconds.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_type</td><td>RSA key type defined in <a class="el" href="optiga__lib__common_8h.html#a05eae1b76c2aea0a97b883b26e9eb220" title="Specifies the RSA key type in OPTIGA.">optiga_rsa_key_type_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_usage</td><td>Key usage defined in <a class="el" href="optiga__lib__common_8h.html#ac9efc8220aa21e6d8324008f6db108d4" title="Specifies the key usage type in OPTIGA.">optiga_key_usage_t</a>.<ul>
<li>Values from <a class="el" href="optiga__lib__common_8h.html#ad388c2786c76065d1d9ce9cffc25670e" title="Specifies the key usage type in OPTIGA.">optiga_key_usage</a> can be logically ORed and passed.<br  />
</li>
<li>It is ignored if export_private_key is TRUE (1) or non-zero. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_private_key</td><td>TRUE (1) or a non-zero value - Exports private key to the host.<br  />
 FALSE (0) - Exports only public key to the host and writes private key to OPTIGA. The input key_usage is ignored. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">private_key</td><td>Buffer to store private key or private key OID of OPTIGA, must not be NULL.<ul>
<li>If export_private_key is TRUE, assign a pointer to a buffer to store the generated private key.</li>
<li>The size of the buffer must be sufficient enough to accommodate the key type and additional DER encoding formats.</li>
<li>If export_private_key is FALSE, assign a pointer to variable of type <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">public_key</td><td>Buffer to store public key, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">public_key_length</td><td>Initially set as length of public_key, later updated as actual length of public_key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_rsa_generate_keypair.c </p>

</div>
</div>
<a id="a49aa659f73e4a77814a2ded710ddb896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49aa659f73e4a77814a2ded710ddb896">&#9670;&nbsp;</a></span>optiga_crypt_rsa_generate_pre_master_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_generate_pre_master_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>optional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>optional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pre_master_secret_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a pre-master secret. </p>
<p>Generates a pre-master secret for RSA key exchange and stores in the acquired session</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#aa1e031bd224b53d5a25e9229fb275f6f" title="Generates random data or pre-master secret for RSA key exchange.">optiga_cmd_get_random</a> API, based on the input arguments.</li>
<li>Generates the pre-master secret</li>
<li>Pre-master secret is stored in session OID.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.<br  />
</li>
<li>Pre Master Secret :<ul>
<li>Minimum length of generated pre master secret is 8 bytes.</li>
<li>The maximum length supported by OPTIGA is 48 bytes.</li>
<li>It is a concatenation of optional data and random secret.</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optional_data</td><td>Optional data that gets prepended to the generated random secret.<ul>
<li>Can be set to NULL, if not required </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optional_data_length</td><td>Length of the optional data provided. It is ignored if optional_data is NULL<ul>
<li>Value can be up to 58 bytes</li>
<li>Difference in shared secret length and optional data length is less than 8 bytes </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pre_master_secret_length</td><td>Length of the shared secret to be generated.<ul>
<li>Length validation for more than maximum length is not done, since OPTIGA will provide an error for an invalid shared secret length.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided.<br  />
<ul>
<li>optional_data_length is more than 40 bytes</li>
<li>Difference in shared secret length and optional data length is less than 8 bytes </li>
</ul>
</td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_encrypt_session.c </p>

</div>
</div>
<a id="aa7942e2997506ec473624e80b70c1926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7942e2997506ec473624e80b70c1926">&#9670;&nbsp;</a></span>optiga_crypt_rsa_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2">optiga_rsa_signature_scheme_t</a>&#160;</td>
          <td class="paramname"><em>signature_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>digest_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>signature_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a RSA signature for the given digest based on the input signature scheme. </p>
<p>Generates a signature for the given digest using private key stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#ab4461677b0c47dee5c46765df7439b97" title="Calculate signature on digest.">optiga_cmd_calc_sign</a> API, based on the input arguments.<br  />
</li>
<li>Generates signature for the input digest.</li>
<li>Exports the generated signature.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_scheme</td><td>RSA signature scheme defined in <a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2" title="Specifies the RSA signature schemes type in OPTIGA.">optiga_rsa_signature_scheme_t</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>Digest on which signature is generated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_length</td><td>Length of the input digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_key</td><td>Private key OID to generate signature. This is static private key only. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">signature</td><td>Pointer to store generated signature, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_length</td><td>Length of signature. Initial value set as length of buffer, later updated as the actual length of generated signature.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the signature. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Reserved for future use. Parameter for RSA PSS signature scheme.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_rsa_sign.c </p>

</div>
</div>
<a id="add0ce1f3f449a1436d8e7071247b4d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add0ce1f3f449a1436d8e7071247b4d5c">&#9670;&nbsp;</a></span>optiga_crypt_rsa_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_rsa_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2">optiga_rsa_signature_scheme_t</a>&#160;</td>
          <td class="paramname"><em>signature_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>digest_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>signature_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key_source_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>salt_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the RSA signature over the given digest. </p>
<p>Verifies the signature over a given digest provided with the input data.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a7214a34d9a267b5322440436f9c4a7ca" title="Verifies the signature over the given digest.">optiga_cmd_verify_sign</a> API, based on the input arguments.<br  />
</li>
<li>Verifies the signature over the given provided with the input data using public key.</li>
<li>It invokes the callback handler of the instance, when it is asynchronously completed.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_scheme</td><td>RSA signature scheme defined in <a class="el" href="optiga__lib__common_8h.html#a2a66c7849768f0e3f7bc44b4fa5fe8f2" title="Specifies the RSA signature schemes type in OPTIGA.">optiga_rsa_signature_scheme_t</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>Pointer to a given digest buffer, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_length</td><td>Length of digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Pointer to a given signature buffer, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_length</td><td>Length of signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key_source_type</td><td>Public key from host / public key of certificate OID from OPTIGA. Value must be one of the below<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a5e14c1c9a9f188d111ddc0c848bb9096" title="Data in internal to optiga OID.">OPTIGA_CRYPT_OID_DATA</a>, if the public key is to used from the certificate data object from OPTIGA.</li>
<li><a class="el" href="optiga__lib__common_8h.html#a217d9d7b44a65748730ac5491ac4b1b8" title="Data is provided by host.">OPTIGA_CRYPT_HOST_DATA</a> or Non-Zero value , if the public key is provided by host. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">public_key</td><td>Public key from host / public key of certificate OID. Value must be one of the below<ul>
<li>For certificate OID, pointer to an OID value must be passed.</li>
<li>For Public key from host, pointer to <a class="el" href="optiga__lib__common_8h.html#aad32b8f3285e1153138d5a795746c9d5" title="Specifies the data structure of the Public Key details (key, size and type)">public_key_from_host_t</a> instance. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_length</td><td>Reserved for future use. Parameter for RSA PSS signature scheme.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_rsa_verify.c </p>

</div>
</div>
<a id="a4940ec40b71d64a6253a01b36aff11c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4940ec40b71d64a6253a01b36aff11c6">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a>&#160;</td>
          <td class="paramname"><em>encryption_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iv_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>associated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>plain_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt the encrypted data using symmetric encryption mode and export plain message to host.<br  />
 </p>
<p>Decrypt the encrypted data using symmetric key from OPTIGA and export the plain data to host.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Decrypts the input message based on the encryption mode.</li>
<li>Use the symmetric key referred by symmetric key OID.</li>
<li>Exports the decrypted message back to host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a>.</li>
</ul>
</li>
<li>The API does not support MAC based encryption modes.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence encrypted data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_mode</td><td>Symmetric encryption mode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OPTIGA symmetric key OID<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data_length</td><td>Length of the data to be decrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Pointer to an IV(initialization vector) or nonce.<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv_length</td><td>Length of the IV<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data</td><td>Pointer to associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of associated data<ul>
<li>Only supported for CBC mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data</td><td>Pointer to buffer to store plain data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data_length</td><td>Pointer to length of the <b>plain_data</b>. Initial value set as length of buffer, later updated as the actual length of plain data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the plain data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a6038c7caf4d1ed90e7c50257fa6d695e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6038c7caf4d1ed90e7c50257fa6d695e">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_decrypt_continue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_decrypt_continue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>plain_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts input encrypted data using symmetric key from OPTIGA and exports block aligned plain data.<br  />
 </p>
<p>Decrypts input encrypted data using symmetric key from OPTIGA and exports block aligned plain data.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Decrypts the input message and exports the decrypted message.<br  />
</li>
<li>Encryption mode and the Symmetric key OID specified in <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> is used to decrypt the data by OPTIGA.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The decryption sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a>, before calling this API.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> is used in this API.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence encrypted data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data_length</td><td>Length of the data to be decrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data</td><td>Pointer to buffer to store plain data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data_length</td><td>Pointer to length of the <b>plain_data</b>. Initial value set as length of buffer, later updated as the actual length of plain data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the plain data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a6f0dc98b43e7c825f6bb358c2f0bdc5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f0dc98b43e7c825f6bb358c2f0bdc5d">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_decrypt_ecb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_decrypt_ecb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>plain_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
 </p>
<p>Decrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Decrypts the input message based on ecb mode.</li>
<li>Use the symmetric key referred by symmetric key OID.</li>
<li>Exports the decrypted message back to host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a>.</li>
</ul>
</li>
<li>No internal padding is performed by OPTIGA, hence encrypted data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OID of the symmetric key object to be used to decrypt the data.<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data</td><td>Pointer to the encrypted data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data_length</td><td>Length of the encrypted data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data</td><td>Pointer to buffer to store decrypted data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data_length</td><td>Pointer to length of the <b>plain_data</b>. Initial value set as length of buffer, later updated as the actual length of plain data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the plain data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt_ecb.c </p>

</div>
</div>
<a id="a0942b29f35aed3b78f59382efdc673ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0942b29f35aed3b78f59382efdc673ba">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_decrypt_final()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_decrypt_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>plain_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts input data using symmetric key from OPTIGA, exports block aligned plain data and completes the decryption sequence.<br  />
 </p>
<p>Decrypts input data using symmetric key from OPTIGA, exports block aligned plain data and completes the decryption sequence.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments to generate and export the plain message to host.<br  />
</li>
<li>Decrypts the input message and exports the decrypted message.<br  />
</li>
<li>Encryption mode and the symmetric key OID specified in <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> is used to decrypt the data by OPTIGA.<br  />
</li>
<li>It terminates the strict sequence.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The decryption sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a>, before calling this API.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> is used in this API.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence encrypted data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#a96b7cead52fda89f0d0a1c0c9cb55f8c" title="Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_decrypt_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data_length</td><td>Length of the data to be decrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data</td><td>Pointer to buffer to store plain data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data_length</td><td>Pointer to length of the <b>plain_data</b>. Initial value set as length of buffer, later updated as the actual length of plain data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the plain data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a96b7cead52fda89f0d0a1c0c9cb55f8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b7cead52fda89f0d0a1c0c9cb55f8c">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_decrypt_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_decrypt_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a>&#160;</td>
          <td class="paramname"><em>encryption_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iv_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>associated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>total_encrypted_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>plain_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.<br  />
 </p>
<p>Initiate symmetric decryption sequence for input data using symmetric key from OPTIGA.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>It marks the beginning of a strict sequence. None of the service layer API will be processed until the strict sequence is terminated.</li>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a583192b36b36404088a040cf13804c93" title="Decrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_decrypt_sym</a> API, based on the input arguments to generate and export the plain message to host.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7ac32906d918dd70bdb565b9ccc184d3" title="When command data is unprotected and response data is protected.">OPTIGA_COMMS_RESPONSE_PROTECTION</a>.</li>
</ul>
</li>
<li>The API does not support MAC based encryption modes.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence encrypted data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated<ul>
<li>In case of an error from lower layer.<br  />
</li>
<li>Same instance is used for other service layer APIs (except <a class="el" href="optiga__crypt_8h.html#a6038c7caf4d1ed90e7c50257fa6d695e" title="Decrypts input encrypted data using symmetric key from OPTIGA and exports block aligned plain data.">optiga_crypt_symmetric_decrypt_continue</a> and <a class="el" href="optiga__crypt_8h.html#a0942b29f35aed3b78f59382efdc673ba" title="Decrypts input data using symmetric key from OPTIGA, exports block aligned plain data and completes t...">optiga_crypt_symmetric_decrypt_final</a>).<br  />
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_mode</td><td>Symmetric encryption mode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OPTIGA symmetric key OID<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encrypted_data_length</td><td>Length of the data to be decrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Pointer to an IV(initialization vector) or nonce.<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv_length</td><td>Length of the IV<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data</td><td>Pointer to associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">total_encrypted_data_length</td><td>Length of total data to be decrypted until <a class="el" href="optiga__crypt_8h.html#a0942b29f35aed3b78f59382efdc673ba" title="Decrypts input data using symmetric key from OPTIGA, exports block aligned plain data and completes t...">optiga_crypt_symmetric_decrypt_final</a>.<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data</td><td>Pointer to buffer to store plain data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">plain_data_length</td><td>Pointer to length of the <b>plain_data</b>. Initial value set as length of buffer, later updated as the actual length of plain data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the plain data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="ac0517f94ee9043996c937725dadfa075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0517f94ee9043996c937725dadfa075">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a>&#160;</td>
          <td class="paramname"><em>encryption_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iv_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>associated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt the data using symmetric encryption mode and export encrypted message to host.<br  />
 </p>
<p>Encrypt the input message using symmetric key from OPTIGA and export the encrypted message to host.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Encrypts the input message based on the encryption mode.</li>
<li>Use the symmetric key referred by symmetric key OID.</li>
<li>Exports the encrypted message back to host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a>.</li>
</ul>
</li>
<li>No internal padding is performed by OPTIGA, hence plain data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_mode</td><td>Symmetric encryption mode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OPTIGA symmetric key OID<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data</td><td>Pointer to the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data_length</td><td>Length of the data to be encrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Pointer to an IV(initialization vector) or nonce.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
</li>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv_length</td><td>Length of the IV<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data</td><td>Pointer to associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data</td><td>Pointer to buffer to store encrypted data </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data_length</td><td>Pointer to length of the <b>encrypted_data</b>. Initial value set as length of buffer, later updated as the actual length of encrypted data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the encrypted data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a495d4acb6f012a3893fbb54a1ec5f424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495d4acb6f012a3893fbb54a1ec5f424">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_encrypt_continue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_encrypt_continue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts input data using symmetric key from OPTIGA and exports block aligned encrypted data.<br  />
 </p>
<p>Encrypts input data using symmetric key from OPTIGA and exports block aligned encrypted data.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Encrypts the input message and exports the encrypted message.<br  />
</li>
<li>Encryption mode and Symmetric key OID specified in <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> is used to encrypt the data by OPTIGA.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.<br  />
</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The encryption sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a>, before calling this API.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> is used in this API.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence plain data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data</td><td>Pointer to the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data_length</td><td>Length of the data to be encrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data</td><td>Pointer to buffer to store encrypted data. Can be NULL for MAC based operations. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data_length</td><td>Pointer to length of the <b>encrypted_data</b>. Initial value set as length of buffer, later updated as the actual length of encrypted data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the encrypted data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a30cec707dd0be9ffb5b0c3255e3ee392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30cec707dd0be9ffb5b0c3255e3ee392">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_encrypt_ecb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_encrypt_ecb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
 </p>
<p>Encrypt the data using symmetric encryption scheme using ECB mode of operation.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>Encrypts the input message in ecb mode.</li>
<li>Use the symmetric key referred by symmetric key OID.</li>
<li>Exports the encrypted message back to host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a>.</li>
</ul>
</li>
<li>No internal padding is performed by OPTIGA hence plain data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OID of the symmetric key object to be used to encrypt the data.<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data</td><td>Pointer to the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data_length</td><td>Length of the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data</td><td>Pointer to buffer to store encrypted data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data_length</td><td>Pointer to length of the <b>encrypted_data</b>. Initial value set as length of buffer, later updated as the actual length of encrypted data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the encrypted data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt_ecb.c </p>

</div>
</div>
<a id="a0d54487694f06de30c69238e91cbfa2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d54487694f06de30c69238e91cbfa2d">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_encrypt_final()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_encrypt_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts input data using symmetric key from OPTIGA, exports block aligned encrypted data and completes the encryption sequence.<br  />
 </p>
<p>Encrypts input data using symmetric key from OPTIGA, exports block aligned encrypted data and completes the encryption sequence.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.</li>
<li>Encrypts the input message and exports the encrypted message.<br  />
</li>
<li>Encryption mode and Symmetric key OID specified in <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> is used to encrypt the data by OPTIGA.<br  />
</li>
<li>It terminates the strict sequence.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>The encryption sequence must have been initiated, by invoking <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a>, before calling this API.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, value set in <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> is used in this API.<br  />
</li>
<li>No internal padding is performed by OPTIGA, hence plain data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated in case of an error from lower layer<br  />
</li>
<li>Invoking this API without successful completion of <a class="el" href="optiga__crypt_8h.html#adea6db1ceeb5610470c46474c0d3b833" title="Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.">optiga_crypt_symmetric_encrypt_start</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data</td><td>Pointer to the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data_length</td><td>Length of the data to be encrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data</td><td>Pointer to buffer to store encrypted data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data_length</td><td>Pointer to length of the <b>encrypted_data</b>. Initial value set as length of buffer, later updated as the actual length of encrypted data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the encrypted data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="adea6db1ceeb5610470c46474c0d3b833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea6db1ceeb5610470c46474c0d3b833">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_encrypt_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_encrypt_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#adeb5bec858a4c05d5a20474b18618532">optiga_symmetric_encryption_mode_t</a>&#160;</td>
          <td class="paramname"><em>encryption_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d">optiga_key_id_t</a>&#160;</td>
          <td class="paramname"><em>symmetric_key_oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iv_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>associated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>total_plain_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>encrypted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>encrypted_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.<br  />
 </p>
<p>Initiates a symmetric encryption sequence for input data using symmetric key from OPTIGA.<br  />
</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments.<br  />
</li>
<li>It marks the beginning of a strict sequence. None of the service layer API will be processed until the strict sequence is terminated.</li>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a28894aba15c63bb461c92f5528cba083" title="Encrypt data using optiga_symmetric_encryption_mode_t encryption scheme.">optiga_cmd_encrypt_sym</a> API, based on the input arguments to generate and export the encrypted message to host.<br  />
</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>Symmetric key must be available at symmetric key OID in OPTIGA.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a>.<ul>
<li>Default protection level for this API is <a class="el" href="optiga__lib__common_8h.html#a7a02a5f19641524fec1e3dd901117eac" title="When command data is protected and response data is unprotected.">OPTIGA_COMMS_COMMAND_PROTECTION</a>.</li>
</ul>
</li>
<li>No internal padding is performed by OPTIGA, hence plain data length must be block aligned (minimum 1 block).<br  />
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
<li>The strict sequence is terminated<ul>
<li>In case of an error from lower layer.<br  />
</li>
<li>Same instance is used for other service layer APIs (except <a class="el" href="optiga__crypt_8h.html#a495d4acb6f012a3893fbb54a1ec5f424" title="Encrypts input data using symmetric key from OPTIGA and exports block aligned encrypted data.">optiga_crypt_symmetric_encrypt_continue</a> and <a class="el" href="optiga__crypt_8h.html#a0d54487694f06de30c69238e91cbfa2d" title="Encrypts input data using symmetric key from OPTIGA, exports block aligned encrypted data and complet...">optiga_crypt_symmetric_encrypt_final</a>).<br  />
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryption_mode</td><td>Symmetric encryption mode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symmetric_key_oid</td><td>OPTIGA symmetric key OID<ul>
<li>Symmetric key must be available at the specified OID.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data</td><td>Pointer to the data to be encrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plain_data_length</td><td>Length of the data to be encrypted.<ul>
<li>It must be block aligned, otherwise OPTIGA returns an error.<br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Pointer to an IV(initialization vector) or nonce.<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv_length</td><td>Length of the IV<ul>
<li>Only supported for CBC and CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data</td><td>Pointer to associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of associated data<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">total_plain_data_length</td><td>Length of total data to be encrypted until <a class="el" href="optiga__crypt_8h.html#a0d54487694f06de30c69238e91cbfa2d" title="Encrypts input data using symmetric key from OPTIGA, exports block aligned encrypted data and complet...">optiga_crypt_symmetric_encrypt_final</a>.<ul>
<li>Only supported for CCM mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data</td><td>Pointer to buffer to store encrypted data. Can be NULL for MAC based operations. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encrypted_data_length</td><td>Pointer to length of the <b>encrypted_data</b>. Initial value set as length of buffer, later updated as the actual length of encrypted data.<ul>
<li>The size of the buffer must be sufficient enough to accommodate the encrypted data.</li>
<li>In case of any error, the value is set to 0.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_encrypt_decrypt.c </p>

</div>
</div>
<a id="a24a46bd4b29fd58b678f616ab092bdc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24a46bd4b29fd58b678f616ab092bdc3">&#9670;&nbsp;</a></span>optiga_crypt_symmetric_generate_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_symmetric_generate_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a315e9ccb8ae245086225762cbadc7684">optiga_symmetric_key_type_t</a>&#160;</td>
          <td class="paramname"><em>key_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_symmetric_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>symmetric_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a symmetric key using OPTIGA. </p>
<p>Generates a symmetric key using OPTIGA for different key sizes.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a7fcbc347d93d8b20e30212e8c2bc7761" title="Generate symmetric key using OPTIGA.">optiga_cmd_gen_symkey</a> API, based on input arguments.</li>
<li>Symmetric key is generated based on the key type.<br  />
</li>
<li>If export to host is requested, exports the symmetric key back to host otherwise stores it in the provided symmetric key OID.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a> before using this API.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a></li>
<li>Error codes from lower layers is returned as it is.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_type</td><td>Key type of <a class="el" href="optiga__lib__common_8h.html#a315e9ccb8ae245086225762cbadc7684" title="Specifies the symmetric key types supported by OPTIGA.">optiga_symmetric_key_type_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_usage</td><td>Key usage defined in <a class="el" href="optiga__lib__common_8h.html#ac9efc8220aa21e6d8324008f6db108d4" title="Specifies the key usage type in OPTIGA.">optiga_key_usage_t</a>.<ul>
<li>It is ignored if export_symmetric_key is TRUE (1) or Non-Zero. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_symmetric_key</td><td>TRUE (1) or Non-Zero value - Exports symmetric key to the host.<br  />
 FALSE (0) - Stores symmetric key in OPTIGA. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">symmetric_key</td><td>Pointer to buffer of symmetric key.<ul>
<li>If export_symmetric_key is TRUE or non-zero, assign pointer to a buffer to store symmetric key.</li>
<li>If export_symmetric_key is FALSE, assign pointer to variable of type <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>.</li>
<li>The size of the buffer must be sufficient enough to accommodate the key.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete. </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_symmetric_generate_key.c </p>

</div>
</div>
<a id="af88dedcdc999e9c558c1943650fb1694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88dedcdc999e9c558c1943650fb1694">&#9670;&nbsp;</a></span>optiga_crypt_tls_prf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_tls_prf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__common_8h.html#a66d576ae92488b491859a7b949d8420b">optiga_tls_prf_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>seed_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key.<br  />
 </p>
<p>Derives a key using the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>Stores the derived key into OPTIGA session context or export it to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>There must be a secret available in the "session context / data object OID" provided as input parameter.<br  />
</li>
<li>If the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> then session must be already available in the instance. (For .e.g Using <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> )</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID..</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Type of scheme to be used for TLS PRF as <a class="el" href="optiga__lib__common_8h.html#a66d576ae92488b491859a7b949d8420b" title="Specifies the key derivation types.">optiga_tls_prf_type_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID where the secret is stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to the label, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>Valid pointer to the seed, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_length</td><td>Length of the seed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>- Wrong Input arguments provided<ul>
<li>Attempt to use a session OID which is not acquired in <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> Session is not available in instance and the secret type is <a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> </li>
</ul>
</td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_tls_prf_sha256.c </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_af88dedcdc999e9c558c1943650fb1694_icgraph.png" border="0" usemap="#aoptiga__crypt_8h_af88dedcdc999e9c558c1943650fb1694_icgraph" alt=""/></div>
<map name="optiga__crypt_8h_af88dedcdc999e9c558c1943650fb1694_icgraph" id="optiga__crypt_8h_af88dedcdc999e9c558c1943650fb1694_icgraph">
<area shape="rect" title="Derives a key." alt="" coords="188,78,323,105"/>
<area shape="rect" href="optiga__crypt_8h.html#a928923b3560515585990a627c0e32714" title="Derives a key using TLS PRF SHA256." alt="" coords="5,5,140,47"/>
<area shape="rect" href="optiga__crypt_8h.html#ab8273f7f0a9809209ab195d990ed5bfc" title="Derives a key using TLS PRF SHA384." alt="" coords="5,71,140,112"/>
<area shape="rect" href="optiga__crypt_8h.html#ab8e291e90a24c92f2da49ff122fa2d47" title="Derives a key using TLS PRF SHA512." alt="" coords="5,136,140,177"/>
</map>
</div>

</div>
</div>
<a id="a928923b3560515585990a627c0e32714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a928923b3560515585990a627c0e32714">&#9670;&nbsp;</a></span>optiga_crypt_tls_prf_sha256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_tls_prf_sha256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>seed_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key using TLS PRF SHA256.<br  />
 </p>
<p>Derives a key TLS PRF SHA256 using the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>Stores the derived key into OPTIGA session context or export it to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>There must be a secret available in the "session context / data object OID" provided as input parameter.<br  />
</li>
<li>Try to access session OID without acquiring session in <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> throws <a class="el" href="optiga__lib__return__codes_8h.html#afdac86846341dd115a3e788327c6af7b" title="OPTIGA command API called with invalid inputs.">OPTIGA_CMD_ERROR_INVALID_INPUT</a> error.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID where the secret is stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to the label, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>Valid pointer to the seed, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_length</td><td>Length of the seed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided<ul>
<li>Attempt to use a session OID which is not acquired in <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> </li>
</ul>
</td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 example_optiga_crypt_tls_prf_sha256.c </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l00706">706</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_a928923b3560515585990a627c0e32714_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_a928923b3560515585990a627c0e32714_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_a928923b3560515585990a627c0e32714_cgraph" id="optiga__crypt_8h_a928923b3560515585990a627c0e32714_cgraph">
<area shape="rect" title="Derives a key using TLS PRF SHA256." alt="" coords="5,5,140,47"/>
<area shape="rect" href="optiga__crypt_8h.html#af88dedcdc999e9c558c1943650fb1694" title="Derives a key." alt="" coords="188,13,323,39"/>
</map>
</div>

</div>
</div>
<a id="ab8273f7f0a9809209ab195d990ed5bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8273f7f0a9809209ab195d990ed5bfc">&#9670;&nbsp;</a></span>optiga_crypt_tls_prf_sha384()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_tls_prf_sha384 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>seed_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key using TLS PRF SHA384.<br  />
 </p>
<p>Derives a key using the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>Stores the derived key into OPTIGA session context or export it to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>There must be a secret available in the "session context / data object OID" provided as input parameter.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID where the secret is stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to the label, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>Valid pointer to the seed, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_length</td><td>Length of the seed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided<ul>
<li>Attempt to use a session OID which is not acquired in <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> </li>
</ul>
</td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 None </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l00776">776</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_ab8273f7f0a9809209ab195d990ed5bfc_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_ab8273f7f0a9809209ab195d990ed5bfc_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_ab8273f7f0a9809209ab195d990ed5bfc_cgraph" id="optiga__crypt_8h_ab8273f7f0a9809209ab195d990ed5bfc_cgraph">
<area shape="rect" title="Derives a key using TLS PRF SHA384." alt="" coords="5,5,140,47"/>
<area shape="rect" href="optiga__crypt_8h.html#af88dedcdc999e9c558c1943650fb1694" title="Derives a key." alt="" coords="188,13,323,39"/>
</map>
</div>

</div>
</div>
<a id="ab8e291e90a24c92f2da49ff122fa2d47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e291e90a24c92f2da49ff122fa2d47">&#9670;&nbsp;</a></span>optiga_crypt_tls_prf_sha512()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="optiga__lib__types_8h.html#aca022c75a28914434eebfc2d65d7a63d">_STATIC_INLINE</a> LIBRARY_EXPORTS <a class="el" href="optiga__lib__types_8h.html#a362af2f8da246164e07fd7b50a67bd8c">optiga_lib_status_t</a> optiga_crypt_tls_prf_sha512 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb">optiga_crypt_t</a> *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>label_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>seed_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>derived_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optiga__lib__types_8h.html#a57c3b7201116536b822f0f8520aa99c7">bool_t</a>&#160;</td>
          <td class="paramname"><em>export_to_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>derived_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives a key using TLS PRF SHA512.<br  />
 </p>
<p>Derives a key using the secret stored in OPTIGA.</p><ul>
<li>Invokes <a class="el" href="optiga__cmd_8h.html#a5b96788bc8de5aa7d05a224e0618ad9b" title="Derives a key.">optiga_cmd_derive_key</a> API, based on the input arguments.<br  />
</li>
<li>Stores the derived key into OPTIGA session context or export it to the host.</li>
<li>The callback registered with instance (<a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>) gets invoked, when the operation is asynchronously completed.</li>
</ul>
<dl class="section pre"><dt>Precondition</dt><dd><ul>
<li>The application on OPTIGA must be opened using <a class="el" href="optiga__util_8h.html#acf602ea51ad8655a6ecc17b54dc94ff2" title="Initializes the communication with optiga and open the application on OPTIGA.">optiga_util_open_application</a>.<br  />
</li>
<li>There must be a secret available in the "session context / data object OID" provided as input parameter.<br  />
</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For <b>protected I2C communication</b>, Refer <a class="el" href="optiga__crypt_8h.html#a6153e3456437ee829b88d638d301a744" title="Enables the protected I2C communication with OPTIGA for CRYPT instances.">OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL</a><ul>
<li>Default protection level for this API is OPTIGA_COMMS_COMMAND_PROTECTION if secret is in session OID.</li>
</ul>
</li>
<li>Error codes from lower layers is returned as it is to the application.<br  />
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">me</td><td>Valid instance of <a class="el" href="optiga__crypt_8h.html#aba51e25e66ba8f1a8c9a0d664ce05ddb" title="OPTIGA crypt instance structure type.">optiga_crypt_t</a> created using <a class="el" href="optiga__crypt_8h.html#aa704c4dce67d7fcd2a2ba9f8a8e68f84" title="Create an instance of optiga_crypt_t.">optiga_crypt_create</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Object ID where the secret is stored in OPTIGA.<ul>
<li><a class="el" href="optiga__lib__common_8h.html#a13a3214c5c1863b571c04b01eae44eb2ad16fd94ab42380ff343b8f32753223fc" title="Key from session (volatile)">OPTIGA_KEY_ID_SESSION_BASED</a> from <a class="el" href="optiga__lib__common_8h.html#ad6deaf6d82edc948ffe97f011abd856d" title="Specifies the key location in OPTIGA.">optiga_key_id_t</a>, indicates the secret is available in the session context acquired by the instance.</li>
<li>or any OPTIGA data object ID(16 bit OID) which holds the secret. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Pointer to the label, can be NULL if not applicable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label_length</td><td>Length of the label. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>Valid pointer to the seed, must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_length</td><td>Length of the seed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derived_key_length</td><td>Length of derived key.<ul>
<li>Export to Host : The minimum length of the derived key can be 1 byte.</li>
<li>Save in Sesssion OID : The minimum length of the derived key should be 16 bytes. <br  />
 For derived key lengths from 1 to 15, OPTIGA derives 16 bytes key in the session OID. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">export_to_host</td><td>TRUE (1) or Non-Zero value - Exports the derived key to Host. <br  />
 FALSE (0) - Stores the derived key into the session object ID acquired by the instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">derived_key</td><td>Pointer to the valid buffer with a minimum size of derived_key_length, in case of exporting the key to host(<b>export_to_host is non-zero value</b>). Otherwise set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a5932a5444a4e33c7667962e31e76e322" title="OPTIGA crypt API execution is successful.">OPTIGA_CRYPT_SUCCESS</a></td><td>Successful invocation </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a2f8a3f5d6b89e376f9ffffa64ffe5fd7" title="OPTIGA crypt API called with invalid inputs.">OPTIGA_CRYPT_ERROR_INVALID_INPUT</a></td><td>Wrong Input arguments provided<ul>
<li>Attempt to use a session OID which is not acquired in <a class="el" href="optiga__crypt_8h.html#a6b0ea46c7efe418f1bd88039c9fe07b4" title="Calculates the shared secret using ECDH algorithm.">optiga_crypt_ecdh</a> </li>
</ul>
</td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a284844e6d26371537d731147b25f9613" title="OPTIGA crypt API called when, a request of same instance is already in service.">OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE</a></td><td>The previous operation with the same instance is not complete </td></tr>
    <tr><td class="paramname"><a class="el" href="optiga__lib__return__codes_8h.html#a725d238392ea8589e8ef1e4e1f28347c" title="OPTIGA Device Error to return OPTIGA security chip specific error codes (Refer Solution reference man...">OPTIGA_DEVICE_ERROR</a></td><td>Command execution failure in OPTIGA and the LSB indicates the error code. (Refer Solution Reference Manual)</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example</b><br  />
 None </p>

<p class="definition">Definition at line <a class="el" href="optiga__crypt_8h_source.html#l00846">846</a> of file <a class="el" href="optiga__crypt_8h_source.html">optiga_crypt.h</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="optiga__crypt_8h_ab8e291e90a24c92f2da49ff122fa2d47_cgraph.png" border="0" usemap="#aoptiga__crypt_8h_ab8e291e90a24c92f2da49ff122fa2d47_cgraph" alt=""/></div>
<map name="optiga__crypt_8h_ab8e291e90a24c92f2da49ff122fa2d47_cgraph" id="optiga__crypt_8h_ab8e291e90a24c92f2da49ff122fa2d47_cgraph">
<area shape="rect" title="Derives a key using TLS PRF SHA512." alt="" coords="5,5,140,47"/>
<area shape="rect" href="optiga__crypt_8h.html#af88dedcdc999e9c558c1943650fb1694" title="Derives a key." alt="" coords="188,13,323,39"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer">
<small>
Copyright &#169  2021 Infineon Technologies AG</a>
</small></address>
</body>
</html>
